const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/MarkdownEditor-CWwEWWi2.js","assets/index-COGy74Um.js","assets/index-oduk54LT.css","assets/clsx-B4VjtFc_.js","assets/utils-B1aiJzso.js","assets/isAddressEqual-n_C7YIwQ.js","assets/secp256k1-EPTfdThe.js"])))=>i.map(i=>d[i]);
var W=e=>{throw TypeError(e)};var K=(e,t,n)=>t.has(e)||W("Cannot "+n);var p=(e,t,n)=>(K(e,t,"read from private field"),n?n.call(e):t.get(e)),_=(e,t,n)=>t.has(e)?W("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n),L=(e,t,n,s)=>(K(e,t,"write to private field"),s?s.call(e,n):t.set(e,n),n),E=(e,t,n)=>(K(e,t,"access private method"),n);import{x as le,y as de,z as pe,B as ye,D as me,F as he,H as fe,I as be,K as ge,N as xe,P as we,Q as Te,T as H,U as ve,V as ee,X as Ce,g as h,n as je,t as ke,j as a,L as Ie,f as G,_ as R,Z as Ne,m as qe,l as Me,e as _e}from"./index-COGy74Um.js";import{c as F}from"./clsx-B4VjtFc_.js";import{n as Le,s as Ee,a as Re,g as te,u as Y,r as V,M as Se}from"./content-LBfjFD9N.js";import{B as D,g as Oe,a as B,u as Pe}from"./useAccount-CYy8IohD.js";import{u as $e,t as Ae,c as Fe}from"./utils-B1aiJzso.js";/* empty css                        */import"./isAddressEqual-n_C7YIwQ.js";import"./secp256k1-EPTfdThe.js";function P(e,t,n){const s=e[t.name];if(typeof s=="function")return s;const i=e[n];return typeof i=="function"?i:r=>t(e,r)}class Qe extends D{constructor(){super("Connector not connected."),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"ConnectorNotConnectedError"})}}class De extends D{constructor({address:t,connector:n}){super(`Account "${t}" not found for connector "${n.name}".`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"ConnectorAccountNotFoundError"})}}class Be extends D{constructor({connectionChainId:t,connectorChainId:n}){super(`The current chain of the connector (id: ${n}) does not match the connection's chain (id: ${t}).`,{metaMessages:[`Current Chain ID:  ${n}`,`Expected Chain ID: ${t}`]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"ConnectorChainMismatchError"})}}class Ue extends D{constructor({connector:t}){super(`Connector "${t.name}" unavailable while reconnecting.`,{details:["During the reconnection step, the only connector methods guaranteed to be available are: `id`, `name`, `type`, `uuid`.","All other methods are not guaranteed to be available until reconnection completes and connectors are fully restored.","This error commonly occurs for connectors that asynchronously inject after reconnection has already started."].join(" ")}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"ConnectorUnavailableReconnectingError"})}}async function ne(e,t={}){let n;if(t.connector){const{connector:u}=t;if(e.state.status==="reconnecting"&&!u.getAccounts&&!u.getChainId)throw new Ue({connector:u});const[m,d]=await Promise.all([u.getAccounts(),u.getChainId()]);n={accounts:m,chainId:d,connector:u}}else n=e.state.connections.get(e.state.current);if(!n)throw new Qe;const s=t.chainId??n.chainId,i=await n.connector.getChainId();if(i!==n.chainId)throw new Be({connectionChainId:n.chainId,connectorChainId:i});const r=n.connector;if(r.getClient)return r.getClient({chainId:s});const c=le(t.account??n.accounts[0]);if(c.address=de(c.address),t.account&&!n.accounts.some(u=>u.toLowerCase()===c.address.toLowerCase()))throw new De({address:c.address,connector:r});const l=e.chains.find(u=>u.id===s),o=await n.connector.getProvider({chainId:s});return pe({account:c,chain:l,name:"Connector Client",transport:u=>ye(o)({...u,retryCount:0})})}function J(e){return e.state.chainId}async function Ke(e,t){const{abi:n,chainId:s,connector:i,...r}=t;let c;t.account?c=t.account:c=(await ne(e,{chainId:s,connector:i})).account;const l=e.getClient({chainId:s}),o=P(l,me,"simulateContract"),{result:u,request:m}=await o({...r,abi:n,account:c});return{chainId:l.chain.id,result:u,request:{__mode:"prepared",...m,chainId:s}}}function ze(e,t){const{onChange:n}=t;return e.subscribe(s=>s.chainId,n)}async function We(e,t){const{chainId:n,timeout:s=0,...i}=t,r=e.getClient({chainId:n}),l=await P(r,fe,"waitForTransactionReceipt")({...i,timeout:s});if(l.status==="reverted"){const u=await P(r,be,"getTransaction")({hash:l.transactionHash}),d=await P(r,ge,"call")({...u,gasPrice:u.type!=="eip1559"?u.gasPrice:void 0,maxFeePerGas:u.type==="eip1559"?u.maxFeePerGas:void 0,maxPriorityFeePerGas:u.type==="eip1559"?u.maxPriorityFeePerGas:void 0}),y=d!=null&&d.data?he(`0x${d.data.substring(138)}`):"unknown reason";throw new Error(y)}return{...l,chainId:r.chain.id}}async function He(e,t){const{account:n,chainId:s,connector:i,__mode:r,...c}=t;let l;typeof n=="object"&&n.type==="local"?l=e.getClient({chainId:s}):l=await ne(e,{account:n,chainId:s,connector:i});const{connector:o}=Oe(e);let u;if(r==="prepared"||o!=null&&o.supportsSimulation)u=c;else{const{request:y}=await Ke(e,{...c,account:n,chainId:s});u=y}return await P(l,xe,"writeContract")({...u,...n?{account:n}:{},chain:s?{id:s}:null})}var I,N,b,v,C,Q,z,Z,Ge=(Z=class extends we{constructor(t,n){super();_(this,C);_(this,I);_(this,N);_(this,b);_(this,v);L(this,I,t),this.setOptions(n),this.bindMethods(),E(this,C,Q).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(t){var s;const n=this.options;this.options=p(this,I).defaultMutationOptions(t),Te(this.options,n)||p(this,I).getMutationCache().notify({type:"observerOptionsUpdated",mutation:p(this,b),observer:this}),n!=null&&n.mutationKey&&this.options.mutationKey&&H(n.mutationKey)!==H(this.options.mutationKey)?this.reset():((s=p(this,b))==null?void 0:s.state.status)==="pending"&&p(this,b).setOptions(this.options)}onUnsubscribe(){var t;this.hasListeners()||(t=p(this,b))==null||t.removeObserver(this)}onMutationUpdate(t){E(this,C,Q).call(this),E(this,C,z).call(this,t)}getCurrentResult(){return p(this,N)}reset(){var t;(t=p(this,b))==null||t.removeObserver(this),L(this,b,void 0),E(this,C,Q).call(this),E(this,C,z).call(this)}mutate(t,n){var s;return L(this,v,n),(s=p(this,b))==null||s.removeObserver(this),L(this,b,p(this,I).getMutationCache().build(p(this,I),this.options)),p(this,b).addObserver(this),p(this,b).execute(t)}},I=new WeakMap,N=new WeakMap,b=new WeakMap,v=new WeakMap,C=new WeakSet,Q=function(){var n;const t=((n=p(this,b))==null?void 0:n.state)??ve();L(this,N,{...t,isPending:t.status==="pending",isSuccess:t.status==="success",isError:t.status==="error",isIdle:t.status==="idle",mutate:this.mutate,reset:this.reset})},z=function(t){ee.batch(()=>{var n,s,i,r,c,l,o,u;if(p(this,v)&&this.hasListeners()){const m=p(this,N).variables,d=p(this,N).context;(t==null?void 0:t.type)==="success"?((s=(n=p(this,v)).onSuccess)==null||s.call(n,t.data,m,d),(r=(i=p(this,v)).onSettled)==null||r.call(i,t.data,null,m,d)):(t==null?void 0:t.type)==="error"&&((l=(c=p(this,v)).onError)==null||l.call(c,t.error,m,d),(u=(o=p(this,v)).onSettled)==null||u.call(o,void 0,t.error,m,d))}this.listeners.forEach(m=>{m(p(this,N))})})},Z);function Ye(e){return JSON.stringify(e,(t,n)=>Ve(n)?Object.keys(n).sort().reduce((s,i)=>(s[i]=n[i],s),{}):typeof n=="bigint"?n.toString():n)}function Ve(e){if(!X(e))return!1;const t=e.constructor;if(typeof t>"u")return!0;const n=t.prototype;return!(!X(n)||!n.hasOwnProperty("isPrototypeOf"))}function X(e){return Object.prototype.toString.call(e)==="[object Object]"}function Je(e){const{_defaulted:t,behavior:n,gcTime:s,initialData:i,initialDataUpdatedAt:r,maxPages:c,meta:l,networkMode:o,queryFn:u,queryHash:m,queryKey:d,queryKeyHashFn:y,retry:g,retryDelay:j,structuralSharing:S,getPreviousPageParam:q,getNextPageParam:w,initialPageParam:M,_optimisticResults:k,enabled:f,notifyOnChangeProps:x,placeholderData:T,refetchInterval:O,refetchIntervalInBackground:$,refetchOnMount:ft,refetchOnReconnect:bt,refetchOnWindowFocus:gt,retryOnMount:xt,select:wt,staleTime:Tt,suspense:vt,throwOnError:Ct,config:jt,connector:kt,query:It,...ce}=e;return ce}function Xe(e,t={}){return{async queryFn({queryKey:n}){const{hash:s,...i}=n[1];if(!s)throw new Error("hash is required");return We(e,{...i,onReplaced:t.onReplaced,hash:s})},queryKey:Ze(t)}}function Ze(e={}){const{onReplaced:t,...n}=e;return["waitForTransactionReceipt",Je(n)]}function et(e){return{mutationFn(t){return He(e,t)},mutationKey:["writeContract"]}}function tt(e,t){const n=Ce(),[s]=h.useState(()=>new Ge(n,e));h.useEffect(()=>{s.setOptions(e)},[s,e]);const i=h.useSyncExternalStore(h.useCallback(c=>s.subscribe(ee.batchCalls(c)),[s]),()=>s.getCurrentResult(),()=>s.getCurrentResult()),r=h.useCallback((c,l)=>{s.mutate(c,l).catch(Le)},[s]);if(i.error&&Ee(s.options.throwOnError,[i.error]))throw i.error;return{...i,mutate:r,mutateAsync:i.mutate}}function nt(e){const t=Re({...e,queryKeyHashFn:Ye});return t.queryKey=e.queryKey,t}function se(e={}){const t=B(e);return h.useSyncExternalStore(n=>ze(t,{onChange:n}),()=>J(t),()=>J(t))}function ae(e={}){const{hash:t,query:n={}}=e,s=B(e),i=se({config:s}),r=Xe(s,{...e,chainId:e.chainId??i}),c=!!(t&&(n.enabled??!0));return nt({...n,...r,enabled:c})}function re(e={}){const{mutation:t}=e,n=B(e),s=et(n),{mutate:i,mutateAsync:r,...c}=tt({...t,...s});return{...c,writeContract:i,writeContractAsync:r}}function st(e,t){const{onChange:n}=t;return e.subscribe(s=>s.chainId,n)}const at=te`
  query ChainDetails($name: String!, $reader: String) {
    questChains(
      where: {
        name_starts_with_nocase: $name,
        name_ends_with_nocase: $name
      }
    ) {
      id
      address
      description
      imageUrl
      token {
        tokenId
        imageUrl
        tokenAddress
        owners(where: { id: $reader }) {
          id
        }
      }
      createdBy {
        id
      }
      updatedAt
      quests(orderBy: questId) {
        questId
        name
        description
        optional
        status { status }
      }
    }
  }
`,rt=te`
  query ChainDetails($chain: String!, $user: String!) {
    questStatuses(where: {
      questChain: $chain, user: $user
    }, orderBy: quest__questId) {
      status
      quest {
        questId
        paused
      }
      submissions {
        name
        description
        details
        externalUrl
      }
    }
  }
`;class it extends Array{constructor(...t){super(),this.current=0,this.push(...t)}get active(){return this[this.current]}}const ie=h.createContext(null),oe=()=>h.useContext(ie),U=()=>{const e=oe();if(!e)throw new Error("No book.");if(e.status==="error")throw e.error;if(e.status==="init")throw new Error(`Loading Book: "${e.title}".`);return e},ot=({slug:e,children:t,chapter:n=0})=>{var q;const[s,i]=h.useState(n),{title:r}=je.map(({books:w})=>w).flat().find(({title:w})=>ke(w)===e)??{};if(!r)throw new Error(`Book "${e}" not found.`);const c=Pe(),l=((q=c==null?void 0:c.address)==null?void 0:q.toLowerCase())??null,{data:{questChains:[o]=[]}={},error:u,isLoading:m}=Y({queryKey:[`chain-${e}`],queryFn:async()=>V("https://api.studio.thegraph.com/query/71457/quest-chains-optimism/version/latest",at,{name:r,reader:l})}),{data:d,error:y}=Y({queryKey:[`statuses-${o==null?void 0:o.id}-${l}`],queryFn:async()=>!l||!(o!=null&&o.id)?null:V("https://api.studio.thegraph.com/query/71457/quest-chains-optimism/version/latest",rt,{chain:o.id,user:l})}),{questStatuses:g}=d??{};let j=null;const S=u??y;if(S)j={status:"error",error:S};else if(m)j={status:"init",slug:e,title:r};else{const w=new it({optional:!0,title:"Introduction",content:o.description,status:"init"},...o.quests.map((k,f)=>{const x=g==null?void 0:g.find(({quest:{questId:T}})=>Number(T)===f);return{optional:k.optional,title:k.name,content:k.description,status:(x==null?void 0:x.status)??null}}));w.current=s;const M={slug:e,title:r,introduction:o.description,chapters:w,creator:o.createdBy.id,owners:[],updatedAt:new Date(Number(o.updatedAt)*1e3),contract:o.id,nft:{id:Number(o.token.tokenId),address:o.token.tokenAddress,image:o.token.imageUrl,minted:o.token.owners.length>0},on:s,setOn:i};l===null?j={status:"load",...M,reader:l}:j={status:"auth",...M,reader:l}}return a.jsx(ie.Provider,{value:j,children:t})};function ut(){const e=U();return a.jsx("ol",{id:"chapters",className:"flex flex-col max-w-72 text-balance mt-4 mr-4 sticky top-0 z-50",children:e.chapters.map((t,n)=>{const{status:s}=t;let i=s==null?"You have not yet submitted a proof for this chapter.":`Your submission ${(()=>{switch(s){case"pass":return"has been approved.";case"fail":return"has been rejected.";case"review":return"is under review.";default:return`has a \`state\` of "${s}".`}})()}`,r=(()=>{switch(s){case"pass":return"fill-green-500";case"fail":return"fill-red-500";case"review":return"fill-orange-400";case null:case void 0:return"fill-blue-400";default:return console.warn(`Unknown \`state\`: "${s}".`),"fill-blue-600"}})();return n===0&&(i="No submission required for this chapter.",r="fill-yellow-500"),a.jsx("li",{"data-tip":i,onClick:()=>{var c;return(c=e.setOn)==null?void 0:c.call(e,n)},className:F("card tooltip tooltip-top md:tooltip-right shadow-md p-3 hover:bg-yellow-300/75 hover:text-black",e.on===n&&"bg-white/20",s==="pass"&&"tooltip-success",s==="fail"&&"tooltip-error",s==="review"&&"tooltip-info",s==="init"&&"tooltip-secondary",s==null&&"tooltip-primary"),children:a.jsxs(Ie,{to:`../${n}`,className:"flex",children:[a.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 50 50",className:"w-8 h-8 flex-shrink-0 mr-2 self-center",children:[a.jsx("circle",{cx:"50%",cy:"50%",r:"40%",className:r,stroke:F(t.optional?"#A44F":"#000B"),strokeWidth:8,strokeDasharray:F(t.optional&&"5 15"),strokeLinecap:"round",paintOrder:"stroke fill"}),a.jsx("text",{x:"50%",y:"57%",fontSize:"2.5rem",textAnchor:"middle",dominantBaseline:"middle",className:"fill-black font-bold",children:n+1})]}),a.jsx("h2",{className:"text-lg font-medium text-left",children:t.title})]})},n)})})}const ue=[{inputs:[],stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!1,internalType:"address",name:"editor",type:"address"},{indexed:!1,internalType:"uint256[]",name:"questIdList",type:"uint256[]"},{components:[{internalType:"bool",name:"paused",type:"bool"},{internalType:"bool",name:"optional",type:"bool"},{internalType:"bool",name:"skipReview",type:"bool"}],indexed:!1,internalType:"struct IQuestChain.QuestDetails[]",name:"questDetails",type:"tuple[]"}],name:"ConfiguredQuests",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint8",name:"version",type:"uint8"}],name:"Initialized",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"address",name:"account",type:"address"}],name:"Paused",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"address",name:"editor",type:"address"},{indexed:!1,internalType:"string",name:"details",type:"string"}],name:"QuestChainEdited",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"string",name:"details",type:"string"},{indexed:!1,internalType:"string[]",name:"quests",type:"string[]"},{indexed:!1,internalType:"bool",name:"paused",type:"bool"}],name:"QuestChainInit",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"string",name:"tokenURI",type:"string"}],name:"QuestChainTokenURIUpdated",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"address",name:"reviewer",type:"address"},{indexed:!1,internalType:"address[]",name:"questerList",type:"address[]"},{indexed:!1,internalType:"uint256[]",name:"questIdList",type:"uint256[]"},{indexed:!1,internalType:"bool[]",name:"successList",type:"bool[]"},{indexed:!1,internalType:"string[]",name:"detailsList",type:"string[]"}],name:"QuestProofsReviewed",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"address",name:"quester",type:"address"},{indexed:!1,internalType:"uint256[]",name:"questIdList",type:"uint256[]"},{indexed:!1,internalType:"string[]",name:"proofList",type:"string[]"}],name:"QuestProofsSubmitted",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"address",name:"creator",type:"address"},{indexed:!1,internalType:"string[]",name:"detailsList",type:"string[]"}],name:"QuestsCreated",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"address",name:"editor",type:"address"},{indexed:!1,internalType:"uint256[]",name:"questIdList",type:"uint256[]"},{indexed:!1,internalType:"string[]",name:"detailsList",type:"string[]"}],name:"QuestsEdited",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"bytes32",name:"role",type:"bytes32"},{indexed:!0,internalType:"bytes32",name:"previousAdminRole",type:"bytes32"},{indexed:!0,internalType:"bytes32",name:"newAdminRole",type:"bytes32"}],name:"RoleAdminChanged",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"bytes32",name:"role",type:"bytes32"},{indexed:!0,internalType:"address",name:"account",type:"address"},{indexed:!0,internalType:"address",name:"sender",type:"address"}],name:"RoleGranted",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"bytes32",name:"role",type:"bytes32"},{indexed:!0,internalType:"address",name:"account",type:"address"},{indexed:!0,internalType:"address",name:"sender",type:"address"}],name:"RoleRevoked",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"address",name:"limiterContract",type:"address"}],name:"SetLimiter",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"address",name:"account",type:"address"}],name:"Unpaused",type:"event"},{inputs:[],name:"ADMIN_ROLE",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[],name:"DEFAULT_ADMIN_ROLE",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[],name:"EDITOR_ROLE",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[],name:"REVIEWER_ROLE",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[],name:"burnToken",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256[]",name:"_questIdList",type:"uint256[]"},{components:[{internalType:"bool",name:"paused",type:"bool"},{internalType:"bool",name:"optional",type:"bool"},{internalType:"bool",name:"skipReview",type:"bool"}],internalType:"struct IQuestChain.QuestDetails[]",name:"_questDetails",type:"tuple[]"}],name:"configureQuests",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"string[]",name:"_detailsList",type:"string[]"}],name:"createQuests",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"string",name:"_details",type:"string"}],name:"edit",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256[]",name:"_questIdList",type:"uint256[]"},{internalType:"string[]",name:"_detailsList",type:"string[]"}],name:"editQuests",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bytes32",name:"role",type:"bytes32"}],name:"getRoleAdmin",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[],name:"getTokenURI",outputs:[{internalType:"string",name:"uri",type:"string"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes32",name:"_role",type:"bytes32"},{internalType:"address",name:"_account",type:"address"}],name:"grantRole",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bytes32",name:"role",type:"bytes32"},{internalType:"address",name:"account",type:"address"}],name:"hasRole",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{components:[{internalType:"address[]",name:"owners",type:"address[]"},{internalType:"address[]",name:"admins",type:"address[]"},{internalType:"address[]",name:"editors",type:"address[]"},{internalType:"address[]",name:"reviewers",type:"address[]"},{internalType:"string[]",name:"quests",type:"string[]"},{internalType:"bool",name:"paused",type:"bool"},{internalType:"string",name:"details",type:"string"},{internalType:"string",name:"tokenURI",type:"string"}],internalType:"struct QuestChainCommons.QuestChainInfo",name:"_info",type:"tuple"}],name:"init",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"limiterContract",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"mintToken",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"pause",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"paused",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[],name:"premium",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[],name:"questChainFactory",outputs:[{internalType:"contract IQuestChainFactory",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"questChainId",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"questChainToken",outputs:[{internalType:"contract IQuestChainToken",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"questCount",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"",type:"uint256"}],name:"questDetails",outputs:[{internalType:"bool",name:"paused",type:"bool"},{internalType:"bool",name:"optional",type:"bool"},{internalType:"bool",name:"skipReview",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"_quester",type:"address"},{internalType:"uint256",name:"_questId",type:"uint256"}],name:"questStatus",outputs:[{internalType:"enum IQuestChain.Status",name:"status",type:"uint8"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes32",name:"role",type:"bytes32"},{internalType:"address",name:"account",type:"address"}],name:"renounceRole",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address[]",name:"_questerList",type:"address[]"},{internalType:"uint256[]",name:"_questIdList",type:"uint256[]"},{internalType:"bool[]",name:"_successList",type:"bool[]"},{internalType:"string[]",name:"_detailsList",type:"string[]"}],name:"reviewProofs",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bytes32",name:"_role",type:"bytes32"},{internalType:"address",name:"_account",type:"address"}],name:"revokeRole",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"_limiterContract",type:"address"}],name:"setLimiter",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"string",name:"_tokenURI",type:"string"}],name:"setTokenURI",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256[]",name:"_questIdList",type:"uint256[]"},{internalType:"string[]",name:"_proofList",type:"string[]"}],name:"submitProofs",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bytes4",name:"interfaceId",type:"bytes4"}],name:"supportsInterface",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[],name:"unpause",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"upgrade",outputs:[],stateMutability:"nonpayable",type:"function"}],A=10,ct=({children:e})=>a.jsxs("div",{role:"alert",className:"alert alert-warning flex items-center mt-10",children:[a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 shrink-0 stroke-current",fill:"none",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),e]}),lt=()=>{const e=U(),t=se(),n=G.useRef(null),[s,i]=h.useState(!1),[r,c]=h.useState({}),l=({type:f,error:x})=>{c(T=>({...T,[f]:x}))},{data:o,writeContract:u,isPending:m}=re(),d=B(),y={chain:{type:"chain",error:a.jsxs("h3",{className:"flex text-center items-center justify-center",children:["Please",a.jsx("a",{onClick:()=>{window.ethereum.request({method:"wallet_switchEthereumChain",params:[{chainId:`0x${A.toString(16)}`}]})},className:"underline text-accent hover:text-accent-content mx-1",children:"switch to the Optimism network"}),"to continue."]})},account:{type:"account",error:a.jsxs("h3",{className:"flex text-center items-center justify-center",children:["Please",a.jsx("div",{className:"mx-2",children:a.jsx("w3m-button",{size:"sm"})}),"to submit a proof."]})}};h.useEffect(()=>{if(d)return st(d,{onChange(f){f!==A&&!r.chain&&l(y.chain)}})},[d]);const{contract:g=null}=e&&"contract"in e?e:{};h.useEffect(()=>{o&&R.success(a.jsxs("p",{children:["Successfully submitted transaction",a.jsxs("a",{href:`https://optimistic.etherscan.io/tx/${o}`,className:"mx-1 whitespace-nowrap text-primary hover:text-secondary",target:"_blank",children:[o.substring(0,8),"…",o.slice(-6)]}),"to the Quest Chain contract at",a.jsxs("a",{href:`https://optimistic.etherscan.io/address/${g}`,className:"ml-1 whitespace-nowrap text-primary hover:text-secondary",target:"_blank",children:[g==null?void 0:g.substring(0,6),"…",g==null?void 0:g.slice(-4)]}),"."]}),{duration:12e3,style:{width:"45ch"}})},[o]);const{isLoading:j,isSuccess:S}=ae({hash:o});e.reader==null&&!r.account?l(y.account):e.reader!=null&&r.account&&l({type:"account",error:null}),t!==A&&!r.chain?l(y.chain):t===A&&r.chain&&l({type:"chain",error:null});const q=Object.values(r).filter(Boolean);if(q.length>0)return q.map((f,x)=>a.jsx(ct,{children:f},x));const w=G.lazy(()=>Ne(()=>import("./MarkdownEditor-CWwEWWi2.js").then(f=>f.w),__vite__mapDeps([0,1,2,3,4,5,6]))),M="Submit Proof",k=j?"Confirming…":m?"Transaction Pending…":s?"Saving to IPFS…":S?"¡Done: Submitted!":M;return a.jsxs(h.Suspense,{fallback:a.jsx("h3",{children:"Loading Submission Editor…"}),children:[a.jsx(w,{editorRef:n,markdown:"",className:"dark-theme dark-editor content mt-10"}),a.jsxs("button",{onClick:async()=>{var x;const f=(x=n.current)==null?void 0:x.getMarkdown();if(!f)throw new Error(`Invalid \`markdown\`: "${f}".`);i(!0);try{const T=new Blob([JSON.stringify({name,description:f})],{type:"application/json"}),O=await $e([new File([T],"submission.json")]);if(R.success(a.jsxs("p",{children:["Successfully uploaded your response submission to",a.jsx("a",{href:"https://web3.storage",target:"_blank",className:"mx-1 whitespace-nowrap text-primary hover:text-secondary",children:"Web3.Storage"}),"at",a.jsxs("a",{href:`https://w3s.link/ipfs/${O}`,target:"_blank",className:"ml-1 whitespace-nowrap text-primary hover:text-secondary",children:["ipfs://",O.substring(0,6),"…",O.slice(-4)]}),"."]}),{duration:15e3,position:"bottom-center",style:{width:"45ch"}}),e.on==null)throw new Error("No current chapter.");u({address:g,abi:ue,functionName:"submitProofs",args:[[e.on-1],[`ipfs://${O}/submission.json`]]},{onError:$=>{console.error({error:$}),R.error($.shortMessage??$.message,{duration:12e3})}})}catch(T){console.error({error:T}),R.error(T.message)}finally{i(!1)}},disabled:k!==M,className:"btn btn-wide text-primary my-6",children:[a.jsx("span",{className:F(k.endsWith("…")&&"loading loading-dots loading-md")}),k]})]})};function dt(){const e=U();return a.jsxs("section",{id:"content",className:"flex-grow",children:[a.jsx("div",{className:"card bg-transparent max-w-prose mt-4 mx-auto",children:a.jsx("div",{className:"content",children:a.jsx(Se,{children:e.chapters.active.content})})}),e.on===0?a.jsx("button",{onClick:()=>e.setOn(e.on+1),className:"shadow-md rounded-md bg-base-300 p-4 hover:bg-yellow-300/60 text-white text-center",children:"Continue"}):["pass"].includes(e.chapters.active.status)?a.jsxs("div",{role:"alert",className:"alert alert-success flex items-center mt-10",children:[a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 shrink-0 stroke-current",fill:"none",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),a.jsx("h2",{className:"grow",children:"You have already successfully completed this submission."}),e.on<e.chapters.length-1&&a.jsxs("button",{onClick:()=>e.setOn(e.on+1),className:"btn btn-primary text-fg font-bold self-end",children:["Next ",a.jsx("span",{className:"size-2xl",children:"→"})]})]}):a.jsx(lt,{})]})}const pt=()=>{var d;const e=U(),{data:t,writeContract:n}=re(),{isLoading:s,isSuccess:i}=ae({hash:t}),[r,c]=h.useState(!1);if(!e)throw new Error("No book found.");const l=()=>{if(!e)throw new Error("No book found.");n({address:e.contract,abi:ue,functionName:"mintToken",args:[]},{onError:y=>{console.error({error:y}),R.error(y.shortMessage??y.message,{duration:12e3})},onSuccess:y=>R.success(a.jsxs("p",{children:["Minted in transaction",a.jsxs("a",{href:`https://optimistic.etherscan.io/tx/${y}`,className:"mx-1 whitespace-nowrap text-primary hover:text-secondary",target:"_blank",children:[y.substring(0,8),"…",y.slice(-6)]}),"."]}),{duration:12e3})})};let o=((d=e.chapters)==null?void 0:d.every(y=>y.status==="pass"||y.optional))&&!e.nft.minted;const u="Mint NFT",m=s?a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"loading loading-spinner loading-md"}),"Confirming…"]}):i?"¡Done: Minted!":u;return a.jsx("div",{id:"reward",className:"flex flex-col ml-4 mt-8 md:mt-1",children:a.jsxs("div",{className:"card rounded-sm bg-secondary/25 h-auto max-w-md mr-4 mx-auto",children:[a.jsx("h1",{className:"text-3xl font-bold text-center my-4 mx-2",children:"Completion NFT"}),a.jsx("img",{onLoad:()=>c(!0),src:Ae(e.nft.image),alt:"Soulbound NFT",className:"w-full h-full object-contain pb-4 px-4"}),!r&&a.jsx("div",{className:"grid place-items-center",children:a.jsx("span",{className:"loading-spinner loading loading-md"})}),o&&a.jsx("button",{disabled:e.nft.minted||m!==u,onClick:l,className:"btn btn-primary",children:m}),e.nft.minted&&a.jsx("h2",{className:"bg-info rounded-md p-4",children:"You've already collected this NFT."})]})})},yt=()=>{var s;const e=oe(),[t,n]=h.useState("Unknown");if(h.useEffect(()=>{e&&"creator"in e&&(n(`${e.creator.substring(0,5)}⋯${e.creator.slice(-3)}`),Fe({chain:qe,transport:Me()}).getEnsName({address:e.creator}).then(r=>{r&&n(r)}))}),e&&e.error)throw e.error;return a.jsxs("header",{children:[a.jsxs("h2",{className:"text-sm text-secondary mt-5 text-left pl-1",children:["Creator: ",t]}),a.jsx("h1",{className:"text-4xl md:text-6xl font-bold text-left mt-2",children:e==null?void 0:e.title}),a.jsxs("p",{className:"text-sm text-white text-left pl-1 mt-6 mb-4",children:["Last Updated:"," ",((s=e==null?void 0:e.updatedAt)==null?void 0:s.toLocaleString(void 0,{day:"numeric",month:"long",year:"numeric"}))??"Unknown"]})]})},mt=_e("/book/$slug/$chapter/")({component:ht});function ht(){try{const{slug:e,chapter:t}=mt.useParams();return a.jsx(ot,{chapter:Number(t),slug:e,children:a.jsxs("article",{id:"top",className:"container mx-auto py-20 px-5 overflow-auto relative",children:[a.jsx(yt,{}),a.jsx("main",{className:"md:flex justify-start overflow-hidden relative",children:a.jsxs(h.Suspense,{fallback:a.jsx("h1",{className:"mt-44",children:"Loading…"}),children:[a.jsx(ut,{}),a.jsx(dt,{}),a.jsx(pt,{})]})})]})})}catch(e){return a.jsxs("h1",{children:["Error: ",e.message]})}}export{ht as Book,mt as Route};
