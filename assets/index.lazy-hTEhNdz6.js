import{c as $,j as n,b as J,H as We,r as w,R as y,e as j,u as C,f as we,g as fe,h as Ge,m as Je,n as Ze,P as et,i as tt,k as be,t as le,l as X,o as F,p as at,q as Z,s as nt,v as st,a as it}from"./index-qFgN0BDJ.js";import{u as rt,S as ot,a as ct,b as lt,c as ht,d as dt,e as pt,f as he,g as de,h as mt,T as ut,i as gt,j as pe,k as K,l as yt,m as z,n as xt,o as wt}from"./table-msoy1onS.js";import{A as ft,a as bt,b as Ct}from"./avatar-O8tfDEHX.js";import{B as jt}from"./book-open-check-Bx9T477h.js";import{C as k,a as R,b as I,d as N}from"./card-D3aIBTSd.js";import{B as O}from"./button-DopvGzQj.js";import{a as E}from"./isGridVisibleAtom-Dt_R12UJ.js";import{M as te}from"./MarkdownEditor-ixLsFA0w.js";import{u as vt}from"./markdown-editor-D4CeGnSr.js";import{c as Tt,m as At}from"./index-DLtqUfxH.js";import{I as kt}from"./input-BXejhhX_.js";import{D as Nt,a as Mt,b as Dt,c as Rt,d as It}from"./dialog-C4GXxKBz.js";import{u as St,D as Pt,b as Et,c as Lt,d as _t,e as Ut}from"./useIsMobile-BXyglk83.js";import{u as Ht,a as $t}from"./index-BdGbLepL.js";import"./index-Da2sJjOt.js";import"./index-B8RrAdm8.js";import"./index-DaLVO-yr.js";import"./tslib.es6-B2dMZmZB.js";import"./useMediaQuery-BsigdLUW.js";import"./useAccount-eqPDiuCN.js";import"./useConfig-BxwOpbe6.js";import"./index-C1SvVhsi.js";import"./isAddressEqual-DOxjMwtg.js";import"./secp256k1-DmO-as0P.js";/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ft=$("BookKey",[["path",{d:"m19 3 1 1",key:"ze14oc"}],["path",{d:"m20 2-4.5 4.5",key:"1sppr8"}],["path",{d:"M20 8v13a1 1 0 0 1-1 1H6.5a1 1 0 0 1 0-5H20",key:"1ocbpn"}],["path",{d:"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H14",key:"1gfsgw"}],["circle",{cx:"14",cy:"8",r:"2",key:"u49eql"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bt=$("BookText",[["path",{d:"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H19a1 1 0 0 1 1 1v18a1 1 0 0 1-1 1H6.5a1 1 0 0 1 0-5H20",key:"k3hazp"}],["path",{d:"M8 11h8",key:"vwpz6n"}],["path",{d:"M8 7h6",key:"1f0q6e"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ot=$("BookType",[["path",{d:"M10 13h4",key:"ytezjc"}],["path",{d:"M12 6v7",key:"1f6ttz"}],["path",{d:"M16 8V6H8v2",key:"x8j6u4"}],["path",{d:"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H19a1 1 0 0 1 1 1v18a1 1 0 0 1-1 1H6.5a1 1 0 0 1 0-5H20",key:"k3hazp"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yt=$("FolderUp",[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}],["path",{d:"M12 10v6",key:"1bos4e"}],["path",{d:"m9 13 3-3 3 3",key:"1pxg3c"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xt=$("ImageUp",[["path",{d:"M10.3 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2v10l-3.1-3.1a2 2 0 0 0-2.814.014L6 21",key:"9csbqa"}],["path",{d:"m14 19.5 3-3 3 3",key:"9vmjn0"}],["path",{d:"M17 22v-5.5",key:"1aa6fl"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kt=$("PartyPopper",[["path",{d:"M5.8 11.3 2 22l10.7-3.79",key:"gwxi1d"}],["path",{d:"M4 3h.01",key:"1vcuye"}],["path",{d:"M22 8h.01",key:"1mrtc2"}],["path",{d:"M15 2h.01",key:"1cjtqr"}],["path",{d:"M22 20h.01",key:"1mrys2"}],["path",{d:"m22 2-2.24.75a2.9 2.9 0 0 0-1.96 3.12c.1.86-.57 1.63-1.45 1.63h-.38c-.86 0-1.6.6-1.76 1.44L14 10",key:"hbicv8"}],["path",{d:"m22 13-.82-.33c-.86-.34-1.82.2-1.98 1.11c-.11.7-.72 1.22-1.43 1.22H17",key:"1i94pl"}],["path",{d:"m11 2 .33.82c.34.86-.2 1.82-1.11 1.98C9.52 4.9 9 5.52 9 6.23V7",key:"1cofks"}],["path",{d:"M11 13c1.93 1.93 2.83 4.17 2 5-.83.83-3.07-.07-5-2-1.93-1.93-2.83-4.17-2-5 .83-.83 3.07.07 5 2Z",key:"4kbmks"}]]);globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(t,e){return this.cache.has(t)?this.cache.get(t):(this.cache.set(t,e),e)}};const q=[{title:"Cover",url:"#upload-cover",value:"item-1",icon:Xt},{title:"Book Title",url:"#book-title",value:"item-2",icon:Ot},{title:"Book Introduction",url:"#book-intro",value:"item-3",icon:jt}],me=[{title:"Chapters",url:"#chapters",value:"item-4",icon:Bt},{title:"Completion NFT",url:"#completion",value:"item-5",icon:Kt},{title:"Owner Permissions",url:"#permissions",value:"item-6",icon:Ft}];function ue(t){return t?`${t.slice(0,5)}…${t.slice(-5)}`:""}function zt({onAccordionChange:t}){const{address:e,ensName:a,ensAvatar:o}=rt(),s=a||ue(e||""),i=c=>{const m=q.find(l=>l.url===c)||me.find(l=>l.url===c);if(m){t(m.value);const l=document.querySelector(c);l&&setTimeout(()=>{l.scrollIntoView({behavior:"smooth",block:"start"})},300)}};return n.jsx(ot,{children:n.jsxs(ct,{children:[n.jsxs(lt,{children:[n.jsx(ht,{children:"Upload Hub"}),n.jsx(dt,{children:n.jsxs(pt,{className:"mt-8",children:[q.map(c=>n.jsx(he,{children:n.jsx(de,{asChild:!0,children:n.jsxs(J,{to:c.url,className:"flex items-center gap-2",onClick:()=>i(c.url),children:[n.jsx(c.icon,{className:"h-4 w-4"}),n.jsx("span",{children:c.title})]})})},c.title)),me.map(c=>n.jsx(he,{children:n.jsx(de,{asChild:!0,children:n.jsxs(J,{to:c.url,className:"flex items-center gap-2",onClick:()=>i(c.url),children:[n.jsx(c.icon,{className:"h-4 w-4"}),n.jsx("span",{children:c.title})]})})},c.title))]})})]}),n.jsxs("div",{className:"mt-auto flex items-center justify-between gap-2 p-4",children:[s?n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs(ft,{children:[n.jsx(bt,{src:o||"https://example.com/avatar.jpg",alt:"Avatar"}),n.jsx(Ct,{children:a?a.slice(0,2).toUpperCase():ue(e||"").slice(0,2).toUpperCase()})]}),n.jsx("div",{children:n.jsx("p",{className:"text-sm font-medium",children:s})})]}):n.jsx("div",{className:"mx-auto",children:n.jsx("w3m-button",{size:"sm"})}),n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(mt,{}),n.jsx(J,{to:"/",className:"flex items-center",children:n.jsx(We,{className:"h-4 w-4"})})]})]})]})})}const Q={x:0,y:0,width:0,height:0,unit:"px"},U=(t,e,a)=>Math.min(Math.max(t,e),a),qt=(...t)=>t.filter(e=>e&&typeof e=="string").join(" "),ge=(t,e)=>t===e||t.width===e.width&&t.height===e.height&&t.x===e.x&&t.y===e.y&&t.unit===e.unit;function Qt(t,e,a,o){const s=A(t,a,o);return t.width&&(s.height=s.width/e),t.height&&(s.width=s.height*e),s.y+s.height>o&&(s.height=o-s.y,s.width=s.height*e),s.x+s.width>a&&(s.width=a-s.x,s.height=s.width/e),t.unit==="%"?D(s,a,o):s}function Vt(t,e,a){const o=A(t,e,a);return o.x=(e-o.width)/2,o.y=(a-o.height)/2,t.unit==="%"?D(o,e,a):o}function D(t,e,a){return t.unit==="%"?{...Q,...t,unit:"%"}:{unit:"%",x:t.x?t.x/e*100:0,y:t.y?t.y/a*100:0,width:t.width?t.width/e*100:0,height:t.height?t.height/a*100:0}}function A(t,e,a){return t.unit?t.unit==="px"?{...Q,...t,unit:"px"}:{unit:"px",x:t.x?t.x*e/100:0,y:t.y?t.y*a/100:0,width:t.width?t.width*e/100:0,height:t.height?t.height*a/100:0}:{...Q,...t,unit:"px"}}function ye(t,e,a,o,s,i=0,c=0,m=o,l=s){const r={...t};let d=Math.min(i,o),u=Math.min(c,s),p=Math.min(m,o),h=Math.min(l,s);e&&(e>1?(d=c?c*e:d,u=d/e,p=m*e):(u=i?i/e:u,d=u*e,h=l/e)),r.y<0&&(r.height=Math.max(r.height+r.y,u),r.y=0),r.x<0&&(r.width=Math.max(r.width+r.x,d),r.x=0);const g=o-(r.x+r.width);g<0&&(r.x=Math.min(r.x,o-d),r.width+=g);const f=s-(r.y+r.height);if(f<0&&(r.y=Math.min(r.y,s-u),r.height+=f),r.width<d&&((a==="sw"||a=="nw")&&(r.x-=d-r.width),r.width=d),r.height<u&&((a==="nw"||a=="ne")&&(r.y-=u-r.height),r.height=u),r.width>p&&((a==="sw"||a=="nw")&&(r.x-=p-r.width),r.width=p),r.height>h&&((a==="nw"||a=="ne")&&(r.y-=h-r.height),r.height=h),e){const b=r.width/r.height;if(b<e){const T=Math.max(r.width/e,u);(a==="nw"||a=="ne")&&(r.y-=T-r.height),r.height=T}else if(b>e){const T=Math.max(r.height*e,d);(a==="sw"||a=="nw")&&(r.x-=T-r.width),r.width=T}}return r}function Wt(t,e,a,o){const s={...t};return e==="ArrowLeft"?o==="nw"?(s.x-=a,s.y-=a,s.width+=a,s.height+=a):o==="w"?(s.x-=a,s.width+=a):o==="sw"?(s.x-=a,s.width+=a,s.height+=a):o==="ne"?(s.y+=a,s.width-=a,s.height-=a):o==="e"?s.width-=a:o==="se"&&(s.width-=a,s.height-=a):e==="ArrowRight"&&(o==="nw"?(s.x+=a,s.y+=a,s.width-=a,s.height-=a):o==="w"?(s.x+=a,s.width-=a):o==="sw"?(s.x+=a,s.width-=a,s.height-=a):o==="ne"?(s.y-=a,s.width+=a,s.height+=a):o==="e"?s.width+=a:o==="se"&&(s.width+=a,s.height+=a)),e==="ArrowUp"?o==="nw"?(s.x-=a,s.y-=a,s.width+=a,s.height+=a):o==="n"?(s.y-=a,s.height+=a):o==="ne"?(s.y-=a,s.width+=a,s.height+=a):o==="sw"?(s.x+=a,s.width-=a,s.height-=a):o==="s"?s.height-=a:o==="se"&&(s.width-=a,s.height-=a):e==="ArrowDown"&&(o==="nw"?(s.x+=a,s.y+=a,s.width-=a,s.height-=a):o==="n"?(s.y+=a,s.height-=a):o==="ne"?(s.y+=a,s.width-=a,s.height-=a):o==="sw"?(s.x-=a,s.width+=a,s.height+=a):o==="s"?s.height+=a:o==="se"&&(s.width+=a,s.height+=a)),s}const H={capture:!0,passive:!1};let Gt=0;const M=class v extends w.PureComponent{constructor(){super(...arguments),this.docMoveBound=!1,this.mouseDownOnCrop=!1,this.dragStarted=!1,this.evData={startClientX:0,startClientY:0,startCropX:0,startCropY:0,clientX:0,clientY:0,isResize:!0},this.componentRef=w.createRef(),this.mediaRef=w.createRef(),this.initChangeCalled=!1,this.instanceId=`rc-${Gt++}`,this.state={cropIsActive:!1,newCropIsBeingDrawn:!1},this.onCropPointerDown=e=>{const{crop:a,disabled:o}=this.props,s=this.getBox();if(!a)return;const i=A(a,s.width,s.height);if(o)return;e.cancelable&&e.preventDefault(),this.bindDocMove(),this.componentRef.current.focus({preventScroll:!0});const c=e.target.dataset.ord,m=!!c;let l=e.clientX,r=e.clientY,d=i.x,u=i.y;if(c){const p=e.clientX-s.x,h=e.clientY-s.y;let g=0,f=0;c==="ne"||c=="e"?(g=p-(i.x+i.width),f=h-i.y,d=i.x,u=i.y+i.height):c==="se"||c==="s"?(g=p-(i.x+i.width),f=h-(i.y+i.height),d=i.x,u=i.y):c==="sw"||c=="w"?(g=p-i.x,f=h-(i.y+i.height),d=i.x+i.width,u=i.y):(c==="nw"||c=="n")&&(g=p-i.x,f=h-i.y,d=i.x+i.width,u=i.y+i.height),l=d+s.x+g,r=u+s.y+f}this.evData={startClientX:l,startClientY:r,startCropX:d,startCropY:u,clientX:e.clientX,clientY:e.clientY,isResize:m,ord:c},this.mouseDownOnCrop=!0,this.setState({cropIsActive:!0})},this.onComponentPointerDown=e=>{const{crop:a,disabled:o,locked:s,keepSelection:i,onChange:c}=this.props,m=this.getBox();if(o||s||i&&a)return;e.cancelable&&e.preventDefault(),this.bindDocMove(),this.componentRef.current.focus({preventScroll:!0});const l=e.clientX-m.x,r=e.clientY-m.y,d={unit:"px",x:l,y:r,width:0,height:0};this.evData={startClientX:e.clientX,startClientY:e.clientY,startCropX:l,startCropY:r,clientX:e.clientX,clientY:e.clientY,isResize:!0},this.mouseDownOnCrop=!0,c(A(d,m.width,m.height),D(d,m.width,m.height)),this.setState({cropIsActive:!0,newCropIsBeingDrawn:!0})},this.onDocPointerMove=e=>{const{crop:a,disabled:o,onChange:s,onDragStart:i}=this.props,c=this.getBox();if(o||!a||!this.mouseDownOnCrop)return;e.cancelable&&e.preventDefault(),this.dragStarted||(this.dragStarted=!0,i&&i(e));const{evData:m}=this;m.clientX=e.clientX,m.clientY=e.clientY;let l;m.isResize?l=this.resizeCrop():l=this.dragCrop(),ge(a,l)||s(A(l,c.width,c.height),D(l,c.width,c.height))},this.onComponentKeyDown=e=>{const{crop:a,disabled:o,onChange:s,onComplete:i}=this.props;if(o)return;const c=e.key;let m=!1;if(!a)return;const l=this.getBox(),r=this.makePixelCrop(l),d=(navigator.platform.match("Mac")?e.metaKey:e.ctrlKey)?v.nudgeStepLarge:e.shiftKey?v.nudgeStepMedium:v.nudgeStep;if(c==="ArrowLeft"?(r.x-=d,m=!0):c==="ArrowRight"?(r.x+=d,m=!0):c==="ArrowUp"?(r.y-=d,m=!0):c==="ArrowDown"&&(r.y+=d,m=!0),m){e.cancelable&&e.preventDefault(),r.x=U(r.x,0,l.width-r.width),r.y=U(r.y,0,l.height-r.height);const u=A(r,l.width,l.height),p=D(r,l.width,l.height);s(u,p),i&&i(u,p)}},this.onHandlerKeyDown=(e,a)=>{const{aspect:o=0,crop:s,disabled:i,minWidth:c=0,minHeight:m=0,maxWidth:l,maxHeight:r,onChange:d,onComplete:u}=this.props,p=this.getBox();if(i||!s)return;if(e.key==="ArrowUp"||e.key==="ArrowDown"||e.key==="ArrowLeft"||e.key==="ArrowRight")e.stopPropagation(),e.preventDefault();else return;const h=(navigator.platform.match("Mac")?e.metaKey:e.ctrlKey)?v.nudgeStepLarge:e.shiftKey?v.nudgeStepMedium:v.nudgeStep,g=A(s,p.width,p.height),f=Wt(g,e.key,h,a),b=ye(f,o,a,p.width,p.height,c,m,l,r);if(!ge(s,b)){const T=D(b,p.width,p.height);d(b,T),u&&u(b,T)}},this.onDocPointerDone=e=>{const{crop:a,disabled:o,onComplete:s,onDragEnd:i}=this.props,c=this.getBox();this.unbindDocMove(),!(o||!a)&&this.mouseDownOnCrop&&(this.mouseDownOnCrop=!1,this.dragStarted=!1,i&&i(e),s&&s(A(a,c.width,c.height),D(a,c.width,c.height)),this.setState({cropIsActive:!1,newCropIsBeingDrawn:!1}))},this.onDragFocus=()=>{var e;(e=this.componentRef.current)==null||e.scrollTo(0,0)}}get document(){return document}getBox(){const e=this.mediaRef.current;if(!e)return{x:0,y:0,width:0,height:0};const{x:a,y:o,width:s,height:i}=e.getBoundingClientRect();return{x:a,y:o,width:s,height:i}}componentDidUpdate(e){const{crop:a,onComplete:o}=this.props;if(o&&!e.crop&&a){const{width:s,height:i}=this.getBox();s&&i&&o(A(a,s,i),D(a,s,i))}}componentWillUnmount(){this.resizeObserver&&this.resizeObserver.disconnect(),this.unbindDocMove()}bindDocMove(){this.docMoveBound||(this.document.addEventListener("pointermove",this.onDocPointerMove,H),this.document.addEventListener("pointerup",this.onDocPointerDone,H),this.document.addEventListener("pointercancel",this.onDocPointerDone,H),this.docMoveBound=!0)}unbindDocMove(){this.docMoveBound&&(this.document.removeEventListener("pointermove",this.onDocPointerMove,H),this.document.removeEventListener("pointerup",this.onDocPointerDone,H),this.document.removeEventListener("pointercancel",this.onDocPointerDone,H),this.docMoveBound=!1)}getCropStyle(){const{crop:e}=this.props;if(e)return{top:`${e.y}${e.unit}`,left:`${e.x}${e.unit}`,width:`${e.width}${e.unit}`,height:`${e.height}${e.unit}`}}dragCrop(){const{evData:e}=this,a=this.getBox(),o=this.makePixelCrop(a),s=e.clientX-e.startClientX,i=e.clientY-e.startClientY;return o.x=U(e.startCropX+s,0,a.width-o.width),o.y=U(e.startCropY+i,0,a.height-o.height),o}getPointRegion(e,a,o,s){const{evData:i}=this,c=i.clientX-e.x,m=i.clientY-e.y;let l;s&&a?l=a==="nw"||a==="n"||a==="ne":l=m<i.startCropY;let r;return o&&a?r=a==="nw"||a==="w"||a==="sw":r=c<i.startCropX,r?l?"nw":"sw":l?"ne":"se"}resolveMinDimensions(e,a,o=0,s=0){const i=Math.min(o,e.width),c=Math.min(s,e.height);return!a||!i&&!c?[i,c]:a>1?i?[i,i/a]:[c*a,c]:c?[c*a,c]:[i,i/a]}resizeCrop(){const{evData:e}=this,{aspect:a=0,maxWidth:o,maxHeight:s}=this.props,i=this.getBox(),[c,m]=this.resolveMinDimensions(i,a,this.props.minWidth,this.props.minHeight);let l=this.makePixelCrop(i);const r=this.getPointRegion(i,e.ord,c,m),d=e.ord||r;let u=e.clientX-e.startClientX,p=e.clientY-e.startClientY;(c&&d==="nw"||d==="w"||d==="sw")&&(u=Math.min(u,-c)),(m&&d==="nw"||d==="n"||d==="ne")&&(p=Math.min(p,-m));const h={unit:"px",x:0,y:0,width:0,height:0};r==="ne"?(h.x=e.startCropX,h.width=u,a?(h.height=h.width/a,h.y=e.startCropY-h.height):(h.height=Math.abs(p),h.y=e.startCropY-h.height)):r==="se"?(h.x=e.startCropX,h.y=e.startCropY,h.width=u,a?h.height=h.width/a:h.height=p):r==="sw"?(h.x=e.startCropX+u,h.y=e.startCropY,h.width=Math.abs(u),a?h.height=h.width/a:h.height=p):r==="nw"&&(h.x=e.startCropX+u,h.width=Math.abs(u),a?(h.height=h.width/a,h.y=e.startCropY-h.height):(h.height=Math.abs(p),h.y=e.startCropY+p));const g=ye(h,a,r,i.width,i.height,c,m,o,s);return a||v.xyOrds.indexOf(d)>-1?l=g:v.xOrds.indexOf(d)>-1?(l.x=g.x,l.width=g.width):v.yOrds.indexOf(d)>-1&&(l.y=g.y,l.height=g.height),l.x=U(l.x,0,i.width-l.width),l.y=U(l.y,0,i.height-l.height),l}renderCropSelection(){const{ariaLabels:e=v.defaultProps.ariaLabels,disabled:a,locked:o,renderSelectionAddon:s,ruleOfThirds:i,crop:c}=this.props,m=this.getCropStyle();if(c)return y.createElement("div",{style:m,className:"ReactCrop__crop-selection",onPointerDown:this.onCropPointerDown,"aria-label":e.cropArea,tabIndex:0,onKeyDown:this.onComponentKeyDown,role:"group"},!a&&!o&&y.createElement("div",{className:"ReactCrop__drag-elements",onFocus:this.onDragFocus},y.createElement("div",{className:"ReactCrop__drag-bar ord-n","data-ord":"n"}),y.createElement("div",{className:"ReactCrop__drag-bar ord-e","data-ord":"e"}),y.createElement("div",{className:"ReactCrop__drag-bar ord-s","data-ord":"s"}),y.createElement("div",{className:"ReactCrop__drag-bar ord-w","data-ord":"w"}),y.createElement("div",{className:"ReactCrop__drag-handle ord-nw","data-ord":"nw",tabIndex:0,"aria-label":e.nwDragHandle,onKeyDown:l=>this.onHandlerKeyDown(l,"nw"),role:"button"}),y.createElement("div",{className:"ReactCrop__drag-handle ord-n","data-ord":"n",tabIndex:0,"aria-label":e.nDragHandle,onKeyDown:l=>this.onHandlerKeyDown(l,"n"),role:"button"}),y.createElement("div",{className:"ReactCrop__drag-handle ord-ne","data-ord":"ne",tabIndex:0,"aria-label":e.neDragHandle,onKeyDown:l=>this.onHandlerKeyDown(l,"ne"),role:"button"}),y.createElement("div",{className:"ReactCrop__drag-handle ord-e","data-ord":"e",tabIndex:0,"aria-label":e.eDragHandle,onKeyDown:l=>this.onHandlerKeyDown(l,"e"),role:"button"}),y.createElement("div",{className:"ReactCrop__drag-handle ord-se","data-ord":"se",tabIndex:0,"aria-label":e.seDragHandle,onKeyDown:l=>this.onHandlerKeyDown(l,"se"),role:"button"}),y.createElement("div",{className:"ReactCrop__drag-handle ord-s","data-ord":"s",tabIndex:0,"aria-label":e.sDragHandle,onKeyDown:l=>this.onHandlerKeyDown(l,"s"),role:"button"}),y.createElement("div",{className:"ReactCrop__drag-handle ord-sw","data-ord":"sw",tabIndex:0,"aria-label":e.swDragHandle,onKeyDown:l=>this.onHandlerKeyDown(l,"sw"),role:"button"}),y.createElement("div",{className:"ReactCrop__drag-handle ord-w","data-ord":"w",tabIndex:0,"aria-label":e.wDragHandle,onKeyDown:l=>this.onHandlerKeyDown(l,"w"),role:"button"})),s&&y.createElement("div",{className:"ReactCrop__selection-addon",onPointerDown:l=>l.stopPropagation()},s(this.state)),i&&y.createElement(y.Fragment,null,y.createElement("div",{className:"ReactCrop__rule-of-thirds-hz"}),y.createElement("div",{className:"ReactCrop__rule-of-thirds-vt"})))}makePixelCrop(e){const a={...Q,...this.props.crop||{}};return A(a,e.width,e.height)}render(){const{aspect:e,children:a,circularCrop:o,className:s,crop:i,disabled:c,locked:m,style:l,ruleOfThirds:r}=this.props,{cropIsActive:d,newCropIsBeingDrawn:u}=this.state,p=i?this.renderCropSelection():null,h=qt("ReactCrop",s,d&&"ReactCrop--active",c&&"ReactCrop--disabled",m&&"ReactCrop--locked",u&&"ReactCrop--new-crop",i&&e&&"ReactCrop--fixed-aspect",i&&o&&"ReactCrop--circular-crop",i&&r&&"ReactCrop--rule-of-thirds",!this.dragStarted&&i&&!i.width&&!i.height&&"ReactCrop--invisible-crop",o&&"ReactCrop--no-animate");return y.createElement("div",{ref:this.componentRef,className:h,style:l},y.createElement("div",{ref:this.mediaRef,className:"ReactCrop__child-wrapper",onPointerDown:this.onComponentPointerDown},a),i?y.createElement("svg",{className:"ReactCrop__crop-mask",width:"100%",height:"100%"},y.createElement("defs",null,y.createElement("mask",{id:`hole-${this.instanceId}`},y.createElement("rect",{width:"100%",height:"100%",fill:"white"}),o?y.createElement("ellipse",{cx:`${i.x+i.width/2}${i.unit}`,cy:`${i.y+i.height/2}${i.unit}`,rx:`${i.width/2}${i.unit}`,ry:`${i.height/2}${i.unit}`,fill:"black"}):y.createElement("rect",{x:`${i.x}${i.unit}`,y:`${i.y}${i.unit}`,width:`${i.width}${i.unit}`,height:`${i.height}${i.unit}`,fill:"black"}))),y.createElement("rect",{fill:"black",fillOpacity:.5,width:"100%",height:"100%",mask:`url(#hole-${this.instanceId})`})):void 0,p)}};M.xOrds=["e","w"],M.yOrds=["n","s"],M.xyOrds=["nw","ne","se","sw"],M.nudgeStep=1,M.nudgeStepMedium=10,M.nudgeStepLarge=100,M.defaultProps={ariaLabels:{cropArea:"Use the arrow keys to move the crop selection area",nwDragHandle:"Use the arrow keys to move the north west drag handle to change the crop selection area",nDragHandle:"Use the up and down arrow keys to move the north drag handle to change the crop selection area",neDragHandle:"Use the arrow keys to move the north east drag handle to change the crop selection area",eDragHandle:"Use the up and down arrow keys to move the east drag handle to change the crop selection area",seDragHandle:"Use the arrow keys to move the south east drag handle to change the crop selection area",sDragHandle:"Use the up and down arrow keys to move the south drag handle to change the crop selection area",swDragHandle:"Use the arrow keys to move the south west drag handle to change the crop selection area",wDragHandle:"Use the up and down arrow keys to move the west drag handle to change the crop selection area"}};let Jt=M;globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(t,e){return this.cache.has(t)?this.cache.get(t):(this.cache.set(t,e),e)}};const S=globalThis.jotaiAtomCache.get("/home/yepyep/dac/dacademy2/src/atoms/frontMatterAtom.ts/frontMatterAtom",E("frontMatter",{},void 0,{getOnInit:!0}));S.debugLabel="frontMatterAtom";const Ce=globalThis.jotaiAtomCache.get("/home/yepyep/dac/dacademy2/src/atoms/frontMatterAtom.ts/coverAtom",j(t=>{var e;return(e=t(S))==null?void 0:e.cover},(t,e,a)=>e(S,o=>({...o,cover:a}))));Ce.debugLabel="coverAtom";const je=globalThis.jotaiAtomCache.get("/home/yepyep/dac/dacademy2/src/atoms/frontMatterAtom.ts/titleAtom",j(t=>{var e;return(e=t(S))==null?void 0:e.title},(t,e,a)=>e(S,o=>({...o,title:a}))));je.debugLabel="titleAtom";const ve=globalThis.jotaiAtomCache.get("/home/yepyep/dac/dacademy2/src/atoms/frontMatterAtom.ts/introAtom",j(t=>{var e;return(e=t(S))==null?void 0:e.introduction},(t,e,a)=>e(S,o=>({...o,introduction:a}))));ve.debugLabel="introAtom";globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(t,e){return this.cache.has(t)?this.cache.get(t):(this.cache.set(t,e),e)}};const Zt=(t,e,a)=>Vt(Qt({unit:"%",width:100},a,t,e),t,e),ea=({image:t})=>{const[e,a]=w.useState(t),o=w.useRef(null),[s,i]=w.useState(),c={width:320,height:480},[m,l]=C(Ce);function r(p){if(p.target.files&&p.target.files.length>0){l(null),i(void 0);const h=new FileReader;h.addEventListener("load",()=>{var g;return a(((g=h.result)==null?void 0:g.toString())||"")}),h.readAsDataURL(p.target.files[0])}}function d(p){if(c){const{width:h,height:g}=p.currentTarget;i(Zt(h,g,c.width/c.height))}}async function u(){const p=o.current;if(!p||!s)throw new Error("Crop canvas does not exist.");const h=document.createElement("canvas");h.width=c.width,h.height=c.height;const g=h.getContext("2d");if(!g)throw new Error("No 2d context");s.unit==="px"&&(s.x=s.x/p.width*100,s.y=s.y/p.height*100,s.width=s.width/p.width*100,s.height=s.height/p.height*100),g.imageSmoothingQuality="high";const f={x:p.naturalWidth*(s.x/100),y:p.naturalHeight*(s.y/100)};g.drawImage(p,f.x,f.y,p.naturalWidth*(s.width/100),p.naturalHeight*(s.height/100),0,0,h.width,h.height);const b=h.toDataURL("image/jpeg");localStorage.setItem("cover",b),l(b)}return n.jsxs("div",{className:"",children:[n.jsx("div",{className:"Crop-Controls",children:n.jsxs("label",{className:"flex justify-center mt-4",children:[m&&n.jsx("img",{src:m,alt:"Crop Preview",className:"max-h-[50vh]"}),!t&&n.jsx("input",{type:"file",accept:"image/*",onChange:r,className:we(!!m&&"hidden","file-input file-input-bordered w-full max-w-xs")})]})}),!!e&&!m&&n.jsx(Jt,{crop:s,onChange:p=>i(p),aspect:c.width/c.height,minHeight:100,className:"max-h-[50vh]",children:n.jsx("img",{ref:o,alt:"Crop me",src:e,onLoad:d})}),!!s&&!m&&n.jsx("div",{children:n.jsx(O,{className:"rounded-md my-4",onClick:u,children:"Crop"})})]})};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(t,e){return this.cache.has(t)?this.cache.get(t):(this.cache.set(t,e),e)}};function ta(){return n.jsxs(k,{className:"w-full",children:[n.jsx(R,{children:n.jsx(I,{className:"text-center text-xl",children:"Cover"})}),n.jsx(N,{className:"text-center",children:n.jsx(ea,{})})]})}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(t,e){return this.cache.has(t)?this.cache.get(t):(this.cache.set(t,e),e)}};function aa(){const t=y.useRef(null),[e,a]=C(ve);return n.jsxs(k,{className:"w-full",children:[n.jsx(R,{children:n.jsx(I,{className:"text-center text-xl",children:"Introduction"})}),n.jsx(N,{className:"text-center flex justify-center",children:n.jsx(te,{editorRef:t,markdown:e??"",className:"dark-theme dark-editor content",onChange:()=>{var o;a(((o=t.current)==null?void 0:o.getMarkdown())??"")}})})]})}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(t,e){return this.cache.has(t)?this.cache.get(t):(this.cache.set(t,e),e)}};const V=({className:t,...e})=>n.jsx("input",{className:fe("max-w-xs my-4 w-full rounded-md border border-input bg-transparent px-3 py-1 text-base shadow-sm transition-colors placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),...e});globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(t,e){return this.cache.has(t)?this.cache.get(t):(this.cache.set(t,e),e)}};const na=({index:t,header:e,contentHeader:a,onDelete:o,atom:s})=>{const i=y.useRef(null),[c,m]=C(s);return n.jsx(k,{className:"flex justify-center",children:n.jsx(N,{className:"text-center",children:n.jsxs("fieldset",{className:"relative border border-secondary p-4",children:[n.jsx("legend",{className:"text-left font-bold",children:e??`Chapter #${t}`}),!!o&&n.jsx("button",{onClick:()=>o(t),className:"absolute top-8 right-8",children:"🗑️"}),n.jsxs("div",{id:`chapter-${t}-title`,className:"mb-4 bg-secondary/25 scroll-m-24",children:[n.jsx("h2",{className:"font-bold",children:"Title"}),n.jsx(V,{onChange:({target:{value:l}})=>{m(r=>({...r,title:l}))},value:c.title??"",id:"title",placeholder:"Title"})]}),n.jsxs("div",{id:`chapter-${t}-content`,className:"mt-4 mb-4 bg-secondary/25 scroll-m-24",children:[n.jsx("h2",{className:"mt-2 font-bold",children:a??"Content"}),n.jsx("div",{className:"flex justify-center mt-4",children:n.jsx(te,{editorRef:i,markdown:c.content??"",className:"dark-theme dark-editor content",onChange:()=>{m(l=>{var r;return{...l,content:((r=i.current)==null?void 0:r.getMarkdown())??""}})}})})]})]})})})};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(t,e){return this.cache.has(t)?this.cache.get(t):(this.cache.set(t,e),e)}};const ae=globalThis.jotaiAtomCache.get("/home/yepyep/dac/dacademy2/src/atoms/usersAtom.ts/usersAtom",E("users",[]));ae.debugLabel="usersAtom";globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(t,e){return this.cache.has(t)?this.cache.get(t):(this.cache.set(t,e),e)}};const xe=({className:t,...e})=>n.jsxs("select",{className:we("px-4 py-2 rounded-md",t),...e,children:[n.jsx("option",{value:"owner",children:"Owner"}),n.jsx("option",{value:"admin",children:"Admin"}),n.jsx("option",{value:"editor",children:"Editor"}),n.jsx("option",{value:"reviewer",children:"Reviewer"})]});function sa(){const[t,e]=w.useState(),[a,o]=w.useState("reviewer"),[s,i]=C(ae),c=(r,d)=>{i(u=>{const p=[...u];return p[r].role=d,p})},m=async r=>{r.preventDefault();try{if(!t)return;const d=Tt({chain:At,transport:Ge()}),u={role:a};if(/^0x(\d|[a-f]){40}$/i.test(t))u.address=t,u.name=await d.getEnsName({address:t})??void 0;else if(Je(t)){if(u.name=t,u.address=await d.getEnsAddress({name:t})??void 0,!u.address)throw new Error(`${t} is not a valid ENS name.`)}else throw new Error(`Invalid name: ${t}`);i(p=>[...p,u]),e("")}catch(d){Ze.error(d.message)}},l=r=>{i(d=>d.toSpliced(r,1))};return n.jsxs(k,{className:"",children:[n.jsx(R,{children:n.jsx(I,{className:"text-center text-xl",children:"Permissions"})}),n.jsxs(N,{className:"",children:[n.jsxs("form",{onSubmit:m,className:"flex flex-wrap gap-4 items-center justify-center",children:[n.jsx(V,{value:t,onChange:({target:{value:r}})=>e(r),className:"w-fit",placeholder:"ETH Address/ENS Name"}),n.jsx(xe,{value:a,onChange:({target:{value:r}})=>o(r)}),n.jsx(O,{children:"Add"})]}),s.length>0&&n.jsxs(ut,{className:"mt-4 w-auto mx-auto",children:[n.jsx(gt,{children:n.jsxs(pe,{className:"bg-transparent hover:bg-transparent cursor-default",children:[n.jsx(K,{className:"w-[100px]",children:"ENS Name"}),n.jsx(K,{children:"ETH Address"}),n.jsx(K,{children:"Role"}),n.jsx(K,{className:"text-right"})]})}),n.jsx(yt,{children:s.map((r,d)=>{var u,p;return n.jsxs(pe,{children:[n.jsx(z,{className:"font-medium",children:r.name}),n.jsx(z,{children:`${(u=r.address)==null?void 0:u.substring(0,7)}…${(p=r.address)==null?void 0:p.slice(-6)}`}),n.jsx(z,{children:n.jsx(xe,{value:r.role,onChange:({target:{value:h}})=>{c(d,h)}})}),n.jsx(z,{children:n.jsx(O,{type:"button",onClick:()=>l(d),children:"Remove"})})]},d)})})]})]})]})}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(t,e){return this.cache.has(t)?this.cache.get(t):(this.cache.set(t,e),e)}};function ia(){const[t,e]=C(je);return n.jsxs(k,{className:"w-full",children:[n.jsx(R,{children:n.jsx(I,{className:"text-center text-xl",children:"Title"})}),n.jsx(N,{className:"text-center",children:n.jsx("div",{className:"flex w-full max-w-sm items-center space-x-2 mx-auto",children:n.jsx(kt,{required:!0,value:t??"",onChange:({target:{value:a}})=>e(a),placeholder:"Book Title"})})})]})}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(t,e){return this.cache.has(t)?this.cache.get(t):(this.cache.set(t,e),e)}};const L=globalThis.jotaiAtomCache.get("/home/yepyep/dac/dacademy2/src/atoms/nftTemplateAtom.ts/nftTemplateAtom",E("nftTemplate",{}));L.debugLabel="nftTemplateAtom";const ne=globalThis.jotaiAtomCache.get("/home/yepyep/dac/dacademy2/src/atoms/nftTemplateAtom.ts/backgroundAtom",j(t=>{var e;return(e=t(L))==null?void 0:e.background},(t,e,a)=>e(L,o=>({...o,background:a}))));ne.debugLabel="backgroundAtom";const Te=globalThis.jotaiAtomCache.get("/home/yepyep/dac/dacademy2/src/atoms/nftTemplateAtom.ts/titleAtom",j(t=>{var e;return(e=t(L))==null?void 0:e.title},(t,e,a)=>e(L,o=>({...o,title:a}))));Te.debugLabel="titleAtom";const Ae=globalThis.jotaiAtomCache.get("/home/yepyep/dac/dacademy2/src/atoms/nftTemplateAtom.ts/colorAtom",j(t=>{var e;return(e=t(L))==null?void 0:e.color},(t,e,a)=>e(L,o=>({...o,color:a}))));Ae.debugLabel="colorAtom";globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(t,e){return this.cache.has(t)?this.cache.get(t):(this.cache.set(t,e),e)}};const ra=({bg:t,title:e,color:a,svgRef:o})=>{const[s]=C(ne),[i]=w.useState(1),[c]=w.useState({x:0,y:0});return n.jsxs("svg",{ref:o,version:"1.1",viewBox:"0 0 200 200",xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%",id:"nft",children:[n.jsxs("defs",{children:[s&&n.jsx("image",{x:c.x,y:c.y,height:`${i*100}%`,width:`${i*100}%`,id:"bg",href:t??void 0}),n.jsx("filter",{id:"blur",colorInterpolationFilters:"sRGB",children:n.jsx("feGaussianBlur",{stdDeviation:"2"})}),n.jsx("rect",{id:"textBox",x:"5%",y:"80%",width:"90%",height:"13%",rx:"4%"}),n.jsx("clipPath",{id:"textClip",children:n.jsx("use",{href:"#textBox"})})]}),s&&n.jsx("g",{children:n.jsx("use",{height:"100%",width:"100%",href:"#bg"})}),e&&n.jsxs(n.Fragment,{children:[n.jsx("use",{filter:"url(#blur)",clipPath:"url(#textClip)",href:"#bg",height:"100%",width:"100%"}),n.jsx("use",{href:"#textBox",fill:"#fff",fillOpacity:".25",filter:"url(#blur)"}),n.jsx("text",{x:"50%",y:"90%",fill:a??"black",fontSize:"133%",stroke:"#0005",strokeWidth:".5",textAnchor:"middle",style:{fontVariationSettings:"'wdth' 87, 'wght' 500"},children:e})]})]})};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(t,e){return this.cache.has(t)?this.cache.get(t):(this.cache.set(t,e),e)}};const P=globalThis.jotaiAtomCache.get("/home/yepyep/dac/dacademy2/src/atoms/nftAtom.ts/nftAtom",E("nft",{},void 0,{getOnInit:!0}));P.debugLabel="nftAtom";const ke=globalThis.jotaiAtomCache.get("/home/yepyep/dac/dacademy2/src/atoms/nftAtom.ts/imageAtom",j(t=>{var e;return(e=t(P))==null?void 0:e.image},(t,e,a)=>e(P,o=>({...o,image:a}))));ke.debugLabel="imageAtom";const Ne=globalThis.jotaiAtomCache.get("/home/yepyep/dac/dacademy2/src/atoms/nftAtom.ts/nameAtom",j(t=>{var e;return(e=t(P))==null?void 0:e.name},(t,e,a)=>e(P,o=>({...o,name:a}))));Ne.debugLabel="nameAtom";const Me=globalThis.jotaiAtomCache.get("/home/yepyep/dac/dacademy2/src/atoms/nftAtom.ts/descriptionAtom",j(t=>{var e;return(e=t(P))==null?void 0:e.description},(t,e,a)=>e(P,o=>({...o,description:a}))));Me.debugLabel="descriptionAtom";var oa="Label",De=w.forwardRef((t,e)=>n.jsx(et.label,{...t,ref:e,onMouseDown:a=>{var s;a.target.closest("button, input, select, textarea")||((s=t.onMouseDown)==null||s.call(t,a),!a.defaultPrevented&&a.detail>1&&a.preventDefault())}}));De.displayName=oa;var Re=De;globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(t,e){return this.cache.has(t)?this.cache.get(t):(this.cache.set(t,e),e)}};const ca=tt("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),ee=w.forwardRef(({className:t,...e},a)=>n.jsx(Re,{ref:a,className:fe(ca(),t),...e}));ee.displayName=Re.displayName;globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(t,e){return this.cache.has(t)?this.cache.get(t):(this.cache.set(t,e),e)}};const la=()=>{const[t,e]=C(ne),[a,o]=C(Te),[s,i]=C(Ae),c=w.useRef(),m=be(ke),[l,r]=C(Ne),[d,u]=C(Me),p=w.useRef(null);return w.useEffect(()=>{var f;const h=(f=c.current)==null?void 0:f.outerHTML;if(!h)throw new Error("Could not generate SVG.");const g=new File([new Blob([h])],"nft.svg");le(g,m)},[a,s,t]),n.jsx("section",{className:"relative",id:"img-config",children:n.jsxs("div",{className:"flex justify-end flex-col gap-4",children:[n.jsxs(k,{className:"w-full",children:[n.jsx(R,{children:n.jsx(I,{className:"text-center",children:"Name"})}),n.jsx(N,{className:"",children:n.jsx(V,{placeholder:"Name",value:l??"",onChange:({target:{value:h}})=>r(h)})})]}),n.jsxs(k,{className:"w-full",children:[n.jsx(R,{children:n.jsx(I,{className:"text-center",children:"Description"})}),n.jsx(N,{className:"text-center flex justify-center",children:n.jsx(te,{editorRef:p,markdown:d??"",className:"dark-theme dark-editor content",onChange:()=>{var h;u(((h=p.current)==null?void 0:h.getMarkdown())??"")}})})]}),n.jsxs(k,{className:"w-full",children:[n.jsx(R,{children:n.jsx(I,{className:"text-center",children:"Overlay"})}),n.jsxs(N,{className:"flex flex-col",children:[n.jsxs("div",{className:"flex justify-center gap-10",children:[n.jsx(V,{placeholder:"Title",value:a??"",onChange:({target:{value:h}})=>o(h)}),n.jsxs(ee,{className:"flex items-center",children:[n.jsx("span",{className:"mr-1",children:"Text Color:"}),n.jsx("input",{type:"color",value:s??"",onChange:({target:{value:h}})=>i(h)})]})]}),n.jsxs(ee,{className:"block max-w-lg mx-auto relative",children:[!t&&n.jsxs("div",{className:"flex flex-col items-center absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-24 mt-8",children:[n.jsx(Yt,{size:48}),n.jsx("h3",{children:"Upload NFT Image"})]}),n.jsx(ra,{bg:t,title:a,color:s,svgRef:c}),n.jsx("input",{onChange:({target:{files:h}})=>{le(h==null?void 0:h[0],e)},type:"file",accept:"image/*",className:"hidden"})]})]})]})]})})};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(t,e){return this.cache.has(t)?this.cache.get(t):(this.cache.set(t,e),e)}};function ha(){return n.jsxs(k,{className:"w-full",children:[n.jsx(R,{children:n.jsx(I,{className:"text-center text-xl",children:"Completion NFT"})}),n.jsx(N,{className:"text-center",children:n.jsx(la,{})})]})}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(t,e){return this.cache.has(t)?this.cache.get(t):(this.cache.set(t,e),e)}};const W=globalThis.jotaiAtomCache.get("/home/yepyep/dac/dacademy2/src/atoms/chapterAtom.ts/chapterIdsAtom",E("chapterIds",[],void 0,{getOnInit:!0}));W.debugLabel="chapterIdsAtom";const se=globalThis.jotaiAtomCache.get("/home/yepyep/dac/dacademy2/src/atoms/chapterAtom.ts/chaptersAtomsAtom",j(t=>t(W).map(e=>E(`chapter-${e}`,{},void 0,{getOnInit:!0})),(t,e,a)=>{const o=crypto.randomUUID(),s=E(`chapter-${o}`,a);s.debugLabel="chapterAtom",s.debugLabel="chapterAtom",e(s,a),e(W,i=>[...i,o])}));se.debugLabel="chaptersAtomsAtom";const Ie=globalThis.jotaiAtomCache.get("/home/yepyep/dac/dacademy2/src/atoms/chapterAtom.ts/removeChapterAtom",j(null,(t,e,a)=>{e(W,o=>o.toSpliced(a,1))}));Ie.debugLabel="removeChapterAtom";const Se=globalThis.jotaiAtomCache.get("/home/yepyep/dac/dacademy2/src/atoms/chapterAtom.ts/chaptersAtom",j(t=>t(se).map(t)));Se.debugLabel="chaptersAtom";const da=[{inputs:[{internalType:"address",name:"_template",type:"address"},{internalType:"address",name:"_admin",type:"address"},{internalType:"address",name:"_treasury",type:"address"},{internalType:"address",name:"_paymentToken",type:"address"},{internalType:"uint256",name:"_upgradeFee",type:"uint256"}],stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!1,internalType:"address",name:"proposedAdmin",type:"address"}],name:"AdminReplaceProposed",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"address",name:"admin",type:"address"}],name:"AdminReplaced",type:"event"},{anonymous:!1,inputs:[],name:"FactorySetup",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"address",name:"proposedPaymentToken",type:"address"}],name:"PaymentTokenReplaceProposed",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"contract IERC20Token",name:"paymentToken",type:"address"}],name:"PaymentTokenReplaced",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint256",name:"index",type:"uint256"},{indexed:!1,internalType:"address",name:"questChain",type:"address"}],name:"QuestChainCreated",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"address",name:"sender",type:"address"},{indexed:!1,internalType:"address",name:"questChain",type:"address"}],name:"QuestChainUpgraded",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint256",name:"proposedUpgradeFee",type:"uint256"}],name:"UpgradeFeeReplaceProposed",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint256",name:"upgradeFee",type:"uint256"}],name:"UpgradeFeeReplaced",type:"event"},{inputs:[],name:"admin",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"adminProposalTimestamp",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{components:[{internalType:"address[]",name:"owners",type:"address[]"},{internalType:"address[]",name:"admins",type:"address[]"},{internalType:"address[]",name:"editors",type:"address[]"},{internalType:"address[]",name:"reviewers",type:"address[]"},{internalType:"string[]",name:"quests",type:"string[]"},{internalType:"bool",name:"paused",type:"bool"},{internalType:"string",name:"details",type:"string"},{internalType:"string",name:"tokenURI",type:"string"}],internalType:"struct QuestChainCommons.QuestChainInfo",name:"_info",type:"tuple"},{internalType:"bytes32",name:"_salt",type:"bytes32"}],name:"create",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"nonpayable",type:"function"},{inputs:[{components:[{internalType:"address[]",name:"owners",type:"address[]"},{internalType:"address[]",name:"admins",type:"address[]"},{internalType:"address[]",name:"editors",type:"address[]"},{internalType:"address[]",name:"reviewers",type:"address[]"},{internalType:"string[]",name:"quests",type:"string[]"},{internalType:"bool",name:"paused",type:"bool"},{internalType:"string",name:"details",type:"string"},{internalType:"string",name:"tokenURI",type:"string"}],internalType:"struct QuestChainCommons.QuestChainInfo",name:"_info",type:"tuple"},{internalType:"bytes32",name:"_salt",type:"bytes32"}],name:"createAndUpgrade",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"nonpayable",type:"function"},{inputs:[{components:[{internalType:"address[]",name:"owners",type:"address[]"},{internalType:"address[]",name:"admins",type:"address[]"},{internalType:"address[]",name:"editors",type:"address[]"},{internalType:"address[]",name:"reviewers",type:"address[]"},{internalType:"string[]",name:"quests",type:"string[]"},{internalType:"bool",name:"paused",type:"bool"},{internalType:"string",name:"details",type:"string"},{internalType:"string",name:"tokenURI",type:"string"}],internalType:"struct QuestChainCommons.QuestChainInfo",name:"_info",type:"tuple"},{internalType:"bytes32",name:"_salt",type:"bytes32"},{internalType:"uint256",name:"_deadline",type:"uint256"},{internalType:"bytes",name:"_signature",type:"bytes"}],name:"createAndUpgradeWithPermit",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"executeAdminReplace",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"executePaymentTokenReplace",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"executeUpgradeFeeReplace",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"_index",type:"uint256"}],name:"getQuestChainAddress",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"paymentToken",outputs:[{internalType:"contract IERC20Token",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"paymentTokenProposalTimestamp",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"_admin",type:"address"}],name:"proposeAdminReplace",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"_paymentToken",type:"address"}],name:"proposePaymentTokenReplace",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"_upgradeFee",type:"uint256"}],name:"proposeUpgradeFeeReplace",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"proposedAdmin",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"proposedPaymentToken",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"proposedUpgradeFee",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"questChainCount",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"questChainTemplate",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"questChainToken",outputs:[{internalType:"contract IQuestChainToken",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"treasury",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"upgradeFee",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"upgradeFeeProposalTimestamp",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"_questChainAddress",type:"address"}],name:"upgradeQuestChain",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"_questChainAddress",type:"address"},{internalType:"uint256",name:"_deadline",type:"uint256"},{internalType:"bytes",name:"_signature",type:"bytes"}],name:"upgradeQuestChainWithPermit",outputs:[],stateMutability:"nonpayable",type:"function"}];globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(t,e){return this.cache.has(t)?this.cache.get(t):(this.cache.set(t,e),e)}};const pa=(t,e)=>[`ipfs://${t}/${e}`,`ipfs://${t.substring(0,3)}…${t.slice(-3)}/${e}`],ma=({url:t,children:e})=>n.jsx("a",{target:"_blank",href:st(t),className:"ml-1 whitespace-nowrap text-primary hover:text-secondary",children:e}),B=(...t)=>{const[e,a]=pa(...t);return{url:e,link:n.jsxs("p",{children:["Saved to ",n.jsx(ma,{url:e,children:a}),"."]})}};function ua(){const[t,e]=w.useState(!0),a=!St(),[o,s]=w.useState([]),i=X(S),c=X(Se),m=X(P),l=X(ae),r=h=>{s(g=>[...g,h])},{writeContract:d}=vt(),u=Ht(),p=$t();return w.useEffect(()=>{const h=new AbortController;return(async()=>{try{const g=h.signal;if(!p)throw new Error("Missing Factory Address");if(!m.image)throw new Error("NFT Missing Image");if(!i.title)throw new Error("Missing Title");if(!i.introduction)throw new Error("Missing Introduction");if(!i.cover)throw new Error("Missing Cover");g.throwIfAborted(),r("Uploading cover to IPFS…");const f=await fetch(i.cover).then(x=>x.blob()).then(x=>F([new File([x],"cover.jpg")])),{url:b,link:T}=B(f,"cover.jpg");r(T),g.throwIfAborted(),r("Uploading frontmatter to IPFS…");const Pe={name:i.title,description:i.introduction,cover:b,slug:at(i.title),categories:[],createdAt:Z()},ie="frontmatter.json",Ee=await F([new File([JSON.stringify(Pe,null,2)],ie)]),{url:Le,link:_e}=B(Ee,ie);r(_e);const Ue=await Promise.all(c.map(async(x,_)=>{g.throwIfAborted(),r(`Uploading chapter #${_+1} to IPFS…`);const G={name:x.title,description:x.content,createdAt:Z()},ce=`chapter.${_+1}.json`,qe=await F([new File([JSON.stringify(G,null,2)],ce)]),{url:Qe,link:Ve}=B(qe,ce);return r(Ve),Qe}));g.throwIfAborted(),r("Uploading NFT Image to IPFS…");const He=await fetch(m.image).then(x=>x.blob()).then(x=>F([new File([x],"image.svg")])),{url:$e,link:Fe}=B(He,"image.svg");r(Fe),g.throwIfAborted(),r("Uploading NFT metadata to IPFS…");const Be={name:m.name,description:m.description,image:$e,properties:{createdAt:Z()}},re="nft.json",Oe=await F([new File([JSON.stringify(Be,null,2)],re)]),{url:Ye,link:Xe}=B(Oe,re);r(Xe);const Ke=Object.groupBy(l,({role:x})=>x??"unknown"),Y=Object.fromEntries(Object.entries(Ke).map(([x,_])=>[x,_==null?void 0:_.map(({address:G})=>G)])),oe=new Uint8Array(32);crypto.getRandomValues(oe);const ze=[{owners:Y.owner??[],admins:Y.admin??[],editors:Y.editor??[],reviewers:Y.reviewer??[],quests:Ue,paused:!1,details:Le,tokenURI:Ye},nt(oe)];g.throwIfAborted(),d({address:p,abi:da,functionName:"create",args:ze},{onError:x=>{console.error({error:x}),r(x.shortMessage??x.message)},onSuccess:x=>r(n.jsxs("p",{children:["Submitted in transaction",n.jsxs("a",{href:`${u}/tx/${x}`,target:"_blank",className:"ml-1 whitespace-nowrap text-primary hover:text-secondary",children:[x.substring(0,8),"…",x.slice(-6)]}),"."]}))})}catch(g){r(n.jsx("p",{className:"text-red-500",children:g.message}))}finally{}})(),()=>h.abort("Mounted twice, aborting double.")},[]),a?n.jsx(Nt,{open:t,onOpenChange:e,children:n.jsx(Mt,{className:"sm:max-w-[425px]",children:n.jsxs(Dt,{children:[n.jsx(Rt,{children:"Uploading Playbook"}),n.jsx(It,{children:n.jsx("ol",{children:o.map(h=>n.jsx("li",{children:h}))})})]})})}):n.jsx(Pt,{open:t,onOpenChange:e,children:n.jsx(Et,{children:n.jsxs(Lt,{className:"text-left",children:[n.jsx(_t,{children:"Uploading Playbook"}),n.jsx(Ut,{children:n.jsx("ol",{children:o.map(h=>n.jsx("li",{children:h}))})})]})})})}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(t,e){return this.cache.has(t)?this.cache.get(t):(this.cache.set(t,e),e)}};const ga=()=>{const[t,e]=w.useState("item-1"),[a,o]=C(se),s=be(Ie),[i,c]=w.useState(!1);w.useEffect(()=>{window.scrollTo(0,0)},[]);const m=l=>{s(l-1)};return w.useEffect(()=>{var r;const l=(r=q.find(d=>d.value===t))==null?void 0:r.url;if(l){const d=document.querySelector(l);d&&setTimeout(()=>{d.scrollIntoView({behavior:"smooth",block:"start"})},300)}},[t,q]),n.jsxs(xt,{children:[n.jsx(zt,{onAccordionChange:e}),n.jsx(wt,{}),n.jsxs("main",{className:"flex-1 mt-12 w-screen mb-8 lg:px-8",children:[n.jsxs("form",{id:"playbook",onSubmit:l=>{l.preventDefault(),c(!0)},children:[n.jsx("div",{id:"upload-cover",className:"pt-8 scroll-mt-12",children:n.jsx(ta,{})}),n.jsx("div",{id:"book-title",className:"pt-8 scroll-mt-12",children:n.jsx(ia,{})}),n.jsx("div",{id:"book-intro",className:"pt-8 scroll-mt-12",children:n.jsx(aa,{})}),n.jsxs("div",{id:"chapters",className:"mt-12 scroll-mt-12 border shadow rounded-lg",children:[n.jsx("h2",{className:"text-center text-xl font-bold py-8",children:"Chapters"}),a.map((l,r)=>n.jsx(na,{atom:l,onDelete:m,index:r+1},r)),n.jsx("div",{className:"flex justify-center mt-4",children:n.jsx(O,{onClick:()=>o({}),type:"button",className:"items-center rounded-md mb-4",children:"Add Chapter"})})]}),n.jsx("div",{id:"completion",className:"pt-8 scroll-mt-12",children:n.jsx(ha,{})})]}),n.jsx("div",{id:"permissions",className:"pt-8 scroll-mt-12",children:n.jsx(sa,{})}),n.jsx("div",{className:"flex justify-center mt-4",children:n.jsx(O,{form:"playbook",className:"secondary",children:"Create Playbook"})}),i&&n.jsx(ua,{})]})]})},Fa=it("/upload/")({component:ga});export{Fa as Route,ga as Upload};
