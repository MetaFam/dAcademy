import{c as B,j as n,b as ye,H as Tt,r as y,R as g,e as j,u as T,f as Nt,g as ee,m as kt,h as Mt,i as Dt,n as Rt,t as He,P as F,k as It,l as Oe,o as Be,p as we,q as Fe,s as Ke,v as St,w as Ye,x as _t,y as Pt,z as Et,C as $t,A as ae,B as W,D as J,a as Ut}from"./index-nBQDF0U9.js";import{u as Lt,S as Ht,a as Ot,b as Bt,c as Ft,d as Kt,e as Yt,f as Se,g as _e,h as Xt,T as zt,i as Vt,j as Pe,k as ne,l as qt,m as se,n as Qt,o as Gt}from"./table-5tRTeGO4.js";import{A as Wt,a as Jt,b as Zt}from"./avatar-BhKP2vFf.js";import{B as ea}from"./book-open-check-CjV-2QGK.js";import{C as K,a as Y,b as X,d as z}from"./card-DhlEUz-m.js";import{B as Z}from"./button-CClQpkhL.js";import{a as E}from"./isGridVisibleAtom-fhY0vNEn.js";import{M as ta}from"./MarkdownEditor-DZT2eQi3.js";import{u as aa}from"./markdown-editor-X4Zj-K28.js";import{c as na}from"./index-C5IdtT-_.js";import{I as sa}from"./input-UWv8lZ1v.js";import{u as oa,D as ia,b as ra,c as ca,d as la,e as da}from"./use-media-query-BCV7djQ3.js";import{D as ha,a as pa,b as ma,c as ua,d as ga}from"./dialog-W4XNqRbK.js";import"./index-A3e18RsP.js";import"./index-DOhPmAii.js";import"./index-D1bQdOY7.js";import"./tslib.es6-B2dMZmZB.js";import"./useAccount-_-DShs_X.js";import"./index-H_98cHel.js";import"./useQuery-B_OITrM0.js";import"./isAddressEqual-DSak4JfE.js";import"./secp256k1-DIkUHlNJ.js";/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ya=B("BookKey",[["path",{d:"m19 3 1 1",key:"ze14oc"}],["path",{d:"m20 2-4.5 4.5",key:"1sppr8"}],["path",{d:"M20 8v13a1 1 0 0 1-1 1H6.5a1 1 0 0 1 0-5H20",key:"1ocbpn"}],["path",{d:"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H14",key:"1gfsgw"}],["circle",{cx:"14",cy:"8",r:"2",key:"u49eql"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xa=B("BookText",[["path",{d:"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H19a1 1 0 0 1 1 1v18a1 1 0 0 1-1 1H6.5a1 1 0 0 1 0-5H20",key:"k3hazp"}],["path",{d:"M8 11h8",key:"vwpz6n"}],["path",{d:"M8 7h6",key:"1f0q6e"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fa=B("BookType",[["path",{d:"M10 13h4",key:"ytezjc"}],["path",{d:"M12 6v7",key:"1f6ttz"}],["path",{d:"M16 8V6H8v2",key:"x8j6u4"}],["path",{d:"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H19a1 1 0 0 1 1 1v18a1 1 0 0 1-1 1H6.5a1 1 0 0 1 0-5H20",key:"k3hazp"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wa=B("FolderUp",[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}],["path",{d:"M12 10v6",key:"1bos4e"}],["path",{d:"m9 13 3-3 3 3",key:"1pxg3c"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ba=B("ImageUp",[["path",{d:"M10.3 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2v10l-3.1-3.1a2 2 0 0 0-2.814.014L6 21",key:"9csbqa"}],["path",{d:"m14 19.5 3-3 3 3",key:"9vmjn0"}],["path",{d:"M17 22v-5.5",key:"1aa6fl"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ca=B("PartyPopper",[["path",{d:"M5.8 11.3 2 22l10.7-3.79",key:"gwxi1d"}],["path",{d:"M4 3h.01",key:"1vcuye"}],["path",{d:"M22 8h.01",key:"1mrtc2"}],["path",{d:"M15 2h.01",key:"1cjtqr"}],["path",{d:"M22 20h.01",key:"1mrys2"}],["path",{d:"m22 2-2.24.75a2.9 2.9 0 0 0-1.96 3.12c.1.86-.57 1.63-1.45 1.63h-.38c-.86 0-1.6.6-1.76 1.44L14 10",key:"hbicv8"}],["path",{d:"m22 13-.82-.33c-.86-.34-1.82.2-1.98 1.11c-.11.7-.72 1.22-1.43 1.22H17",key:"1i94pl"}],["path",{d:"m11 2 .33.82c.34.86-.2 1.82-1.11 1.98C9.52 4.9 9 5.52 9 6.23V7",key:"1cofks"}],["path",{d:"M11 13c1.93 1.93 2.83 4.17 2 5-.83.83-3.07-.07-5-2-1.93-1.93-2.83-4.17-2-5 .83-.83 3.07.07 5 2Z",key:"4kbmks"}]]);globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(t,e){return this.cache.has(t)?this.cache.get(t):(this.cache.set(t,e),e)}};const ce=[{title:"Cover",url:"#upload-cover",value:"item-1",icon:ba},{title:"Book Title",url:"#book-title",value:"item-2",icon:fa},{title:"Book Introduction",url:"#book-intro",value:"item-3",icon:ea}],Ee=[{title:"Chapters",url:"#chapters",value:"item-4",icon:xa},{title:"Completion NFT",url:"#completion",value:"item-5",icon:Ca},{title:"Owner Permissions",url:"#permissions",value:"item-6",icon:ya}];function $e(t){return t?`${t.slice(0,5)}â€¦${t.slice(-5)}`:""}function va({onAccordionChange:t}){const{address:e,ensName:a,ensAvatar:i}=Lt(),s=a||$e(e||""),o=l=>{const d=ce.find(c=>c.url===l)||Ee.find(c=>c.url===l);if(d){t(d.value);const c=document.querySelector(l);c&&setTimeout(()=>{c.scrollIntoView({behavior:"smooth",block:"start"})},300)}};return n.jsx(Ht,{children:n.jsxs(Ot,{children:[n.jsxs(Bt,{children:[n.jsx(Ft,{children:"Upload Hub"}),n.jsx(Kt,{children:n.jsxs(Yt,{className:"mt-8",children:[ce.map(l=>n.jsx(Se,{children:n.jsx(_e,{asChild:!0,children:n.jsxs(ye,{to:l.url,className:"flex items-center gap-2",onClick:()=>o(l.url),children:[n.jsx(l.icon,{className:"h-4 w-4"}),n.jsx("span",{children:l.title})]})})},l.title)),Ee.map(l=>n.jsx(Se,{children:n.jsx(_e,{asChild:!0,children:n.jsxs(ye,{to:l.url,className:"flex items-center gap-2",onClick:()=>o(l.url),children:[n.jsx(l.icon,{className:"h-4 w-4"}),n.jsx("span",{children:l.title})]})})},l.title))]})})]}),n.jsxs("div",{className:"mt-auto flex items-center justify-between gap-2 p-4",children:[s?n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs(Wt,{children:[n.jsx(Jt,{src:i||"https://example.com/avatar.jpg",alt:"Avatar"}),n.jsx(Zt,{children:a?a.slice(0,2).toUpperCase():$e(e||"").slice(0,2).toUpperCase()})]}),n.jsx("div",{children:n.jsx("p",{className:"text-sm font-medium",children:s})})]}):n.jsx("div",{className:"mx-auto",children:n.jsx("w3m-button",{size:"sm"})}),n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(Xt,{}),n.jsx(ye,{to:"/",className:"flex items-center",children:n.jsx(Tt,{className:"h-4 w-4"})})]})]})]})})}const le={x:0,y:0,width:0,height:0,unit:"px"},H=(t,e,a)=>Math.min(Math.max(t,e),a),ja=(...t)=>t.filter(e=>e&&typeof e=="string").join(" "),Ue=(t,e)=>t===e||t.width===e.width&&t.height===e.height&&t.x===e.x&&t.y===e.y&&t.unit===e.unit;function Aa(t,e,a,i){const s=N(t,a,i);return t.width&&(s.height=s.width/e),t.height&&(s.width=s.height*e),s.y+s.height>i&&(s.height=i-s.y,s.width=s.height*e),s.x+s.width>a&&(s.width=a-s.x,s.height=s.width/e),t.unit==="%"?R(s,a,i):s}function Ta(t,e,a){const i=N(t,e,a);return i.x=(e-i.width)/2,i.y=(a-i.height)/2,t.unit==="%"?R(i,e,a):i}function R(t,e,a){return t.unit==="%"?{...le,...t,unit:"%"}:{unit:"%",x:t.x?t.x/e*100:0,y:t.y?t.y/a*100:0,width:t.width?t.width/e*100:0,height:t.height?t.height/a*100:0}}function N(t,e,a){return t.unit?t.unit==="px"?{...le,...t,unit:"px"}:{unit:"px",x:t.x?t.x*e/100:0,y:t.y?t.y*a/100:0,width:t.width?t.width*e/100:0,height:t.height?t.height*a/100:0}:{...le,...t,unit:"px"}}function Le(t,e,a,i,s,o=0,l=0,d=i,c=s){const r={...t};let m=Math.min(o,i),u=Math.min(l,s),h=Math.min(d,i),p=Math.min(c,s);e&&(e>1?(m=l?l*e:m,u=m/e,h=d*e):(u=o?o/e:u,m=u*e,p=c/e)),r.y<0&&(r.height=Math.max(r.height+r.y,u),r.y=0),r.x<0&&(r.width=Math.max(r.width+r.x,m),r.x=0);const x=i-(r.x+r.width);x<0&&(r.x=Math.min(r.x,i-m),r.width+=x);const f=s-(r.y+r.height);if(f<0&&(r.y=Math.min(r.y,s-u),r.height+=f),r.width<m&&((a==="sw"||a=="nw")&&(r.x-=m-r.width),r.width=m),r.height<u&&((a==="nw"||a=="ne")&&(r.y-=u-r.height),r.height=u),r.width>h&&((a==="sw"||a=="nw")&&(r.x-=h-r.width),r.width=h),r.height>p&&((a==="nw"||a=="ne")&&(r.y-=p-r.height),r.height=p),e){const w=r.width/r.height;if(w<e){const v=Math.max(r.width/e,u);(a==="nw"||a=="ne")&&(r.y-=v-r.height),r.height=v}else if(w>e){const v=Math.max(r.height*e,m);(a==="sw"||a=="nw")&&(r.x-=v-r.width),r.width=v}}return r}function Na(t,e,a,i){const s={...t};return e==="ArrowLeft"?i==="nw"?(s.x-=a,s.y-=a,s.width+=a,s.height+=a):i==="w"?(s.x-=a,s.width+=a):i==="sw"?(s.x-=a,s.width+=a,s.height+=a):i==="ne"?(s.y+=a,s.width-=a,s.height-=a):i==="e"?s.width-=a:i==="se"&&(s.width-=a,s.height-=a):e==="ArrowRight"&&(i==="nw"?(s.x+=a,s.y+=a,s.width-=a,s.height-=a):i==="w"?(s.x+=a,s.width-=a):i==="sw"?(s.x+=a,s.width-=a,s.height-=a):i==="ne"?(s.y-=a,s.width+=a,s.height+=a):i==="e"?s.width+=a:i==="se"&&(s.width+=a,s.height+=a)),e==="ArrowUp"?i==="nw"?(s.x-=a,s.y-=a,s.width+=a,s.height+=a):i==="n"?(s.y-=a,s.height+=a):i==="ne"?(s.y-=a,s.width+=a,s.height+=a):i==="sw"?(s.x+=a,s.width-=a,s.height-=a):i==="s"?s.height-=a:i==="se"&&(s.width-=a,s.height-=a):e==="ArrowDown"&&(i==="nw"?(s.x+=a,s.y+=a,s.width-=a,s.height-=a):i==="n"?(s.y+=a,s.height-=a):i==="ne"?(s.y+=a,s.width-=a,s.height-=a):i==="sw"?(s.x-=a,s.width+=a,s.height+=a):i==="s"?s.height+=a:i==="se"&&(s.width+=a,s.height+=a)),s}const O={capture:!0,passive:!1};let ka=0;const D=class A extends y.PureComponent{constructor(){super(...arguments),this.docMoveBound=!1,this.mouseDownOnCrop=!1,this.dragStarted=!1,this.evData={startClientX:0,startClientY:0,startCropX:0,startCropY:0,clientX:0,clientY:0,isResize:!0},this.componentRef=y.createRef(),this.mediaRef=y.createRef(),this.initChangeCalled=!1,this.instanceId=`rc-${ka++}`,this.state={cropIsActive:!1,newCropIsBeingDrawn:!1},this.onCropPointerDown=e=>{const{crop:a,disabled:i}=this.props,s=this.getBox();if(!a)return;const o=N(a,s.width,s.height);if(i)return;e.cancelable&&e.preventDefault(),this.bindDocMove(),this.componentRef.current.focus({preventScroll:!0});const l=e.target.dataset.ord,d=!!l;let c=e.clientX,r=e.clientY,m=o.x,u=o.y;if(l){const h=e.clientX-s.x,p=e.clientY-s.y;let x=0,f=0;l==="ne"||l=="e"?(x=h-(o.x+o.width),f=p-o.y,m=o.x,u=o.y+o.height):l==="se"||l==="s"?(x=h-(o.x+o.width),f=p-(o.y+o.height),m=o.x,u=o.y):l==="sw"||l=="w"?(x=h-o.x,f=p-(o.y+o.height),m=o.x+o.width,u=o.y):(l==="nw"||l=="n")&&(x=h-o.x,f=p-o.y,m=o.x+o.width,u=o.y+o.height),c=m+s.x+x,r=u+s.y+f}this.evData={startClientX:c,startClientY:r,startCropX:m,startCropY:u,clientX:e.clientX,clientY:e.clientY,isResize:d,ord:l},this.mouseDownOnCrop=!0,this.setState({cropIsActive:!0})},this.onComponentPointerDown=e=>{const{crop:a,disabled:i,locked:s,keepSelection:o,onChange:l}=this.props,d=this.getBox();if(i||s||o&&a)return;e.cancelable&&e.preventDefault(),this.bindDocMove(),this.componentRef.current.focus({preventScroll:!0});const c=e.clientX-d.x,r=e.clientY-d.y,m={unit:"px",x:c,y:r,width:0,height:0};this.evData={startClientX:e.clientX,startClientY:e.clientY,startCropX:c,startCropY:r,clientX:e.clientX,clientY:e.clientY,isResize:!0},this.mouseDownOnCrop=!0,l(N(m,d.width,d.height),R(m,d.width,d.height)),this.setState({cropIsActive:!0,newCropIsBeingDrawn:!0})},this.onDocPointerMove=e=>{const{crop:a,disabled:i,onChange:s,onDragStart:o}=this.props,l=this.getBox();if(i||!a||!this.mouseDownOnCrop)return;e.cancelable&&e.preventDefault(),this.dragStarted||(this.dragStarted=!0,o&&o(e));const{evData:d}=this;d.clientX=e.clientX,d.clientY=e.clientY;let c;d.isResize?c=this.resizeCrop():c=this.dragCrop(),Ue(a,c)||s(N(c,l.width,l.height),R(c,l.width,l.height))},this.onComponentKeyDown=e=>{const{crop:a,disabled:i,onChange:s,onComplete:o}=this.props;if(i)return;const l=e.key;let d=!1;if(!a)return;const c=this.getBox(),r=this.makePixelCrop(c),m=(navigator.platform.match("Mac")?e.metaKey:e.ctrlKey)?A.nudgeStepLarge:e.shiftKey?A.nudgeStepMedium:A.nudgeStep;if(l==="ArrowLeft"?(r.x-=m,d=!0):l==="ArrowRight"?(r.x+=m,d=!0):l==="ArrowUp"?(r.y-=m,d=!0):l==="ArrowDown"&&(r.y+=m,d=!0),d){e.cancelable&&e.preventDefault(),r.x=H(r.x,0,c.width-r.width),r.y=H(r.y,0,c.height-r.height);const u=N(r,c.width,c.height),h=R(r,c.width,c.height);s(u,h),o&&o(u,h)}},this.onHandlerKeyDown=(e,a)=>{const{aspect:i=0,crop:s,disabled:o,minWidth:l=0,minHeight:d=0,maxWidth:c,maxHeight:r,onChange:m,onComplete:u}=this.props,h=this.getBox();if(o||!s)return;if(e.key==="ArrowUp"||e.key==="ArrowDown"||e.key==="ArrowLeft"||e.key==="ArrowRight")e.stopPropagation(),e.preventDefault();else return;const p=(navigator.platform.match("Mac")?e.metaKey:e.ctrlKey)?A.nudgeStepLarge:e.shiftKey?A.nudgeStepMedium:A.nudgeStep,x=N(s,h.width,h.height),f=Na(x,e.key,p,a),w=Le(f,i,a,h.width,h.height,l,d,c,r);if(!Ue(s,w)){const v=R(w,h.width,h.height);m(w,v),u&&u(w,v)}},this.onDocPointerDone=e=>{const{crop:a,disabled:i,onComplete:s,onDragEnd:o}=this.props,l=this.getBox();this.unbindDocMove(),!(i||!a)&&this.mouseDownOnCrop&&(this.mouseDownOnCrop=!1,this.dragStarted=!1,o&&o(e),s&&s(N(a,l.width,l.height),R(a,l.width,l.height)),this.setState({cropIsActive:!1,newCropIsBeingDrawn:!1}))},this.onDragFocus=()=>{var e;(e=this.componentRef.current)==null||e.scrollTo(0,0)}}get document(){return document}getBox(){const e=this.mediaRef.current;if(!e)return{x:0,y:0,width:0,height:0};const{x:a,y:i,width:s,height:o}=e.getBoundingClientRect();return{x:a,y:i,width:s,height:o}}componentDidUpdate(e){const{crop:a,onComplete:i}=this.props;if(i&&!e.crop&&a){const{width:s,height:o}=this.getBox();s&&o&&i(N(a,s,o),R(a,s,o))}}componentWillUnmount(){this.resizeObserver&&this.resizeObserver.disconnect(),this.unbindDocMove()}bindDocMove(){this.docMoveBound||(this.document.addEventListener("pointermove",this.onDocPointerMove,O),this.document.addEventListener("pointerup",this.onDocPointerDone,O),this.document.addEventListener("pointercancel",this.onDocPointerDone,O),this.docMoveBound=!0)}unbindDocMove(){this.docMoveBound&&(this.document.removeEventListener("pointermove",this.onDocPointerMove,O),this.document.removeEventListener("pointerup",this.onDocPointerDone,O),this.document.removeEventListener("pointercancel",this.onDocPointerDone,O),this.docMoveBound=!1)}getCropStyle(){const{crop:e}=this.props;if(e)return{top:`${e.y}${e.unit}`,left:`${e.x}${e.unit}`,width:`${e.width}${e.unit}`,height:`${e.height}${e.unit}`}}dragCrop(){const{evData:e}=this,a=this.getBox(),i=this.makePixelCrop(a),s=e.clientX-e.startClientX,o=e.clientY-e.startClientY;return i.x=H(e.startCropX+s,0,a.width-i.width),i.y=H(e.startCropY+o,0,a.height-i.height),i}getPointRegion(e,a,i,s){const{evData:o}=this,l=o.clientX-e.x,d=o.clientY-e.y;let c;s&&a?c=a==="nw"||a==="n"||a==="ne":c=d<o.startCropY;let r;return i&&a?r=a==="nw"||a==="w"||a==="sw":r=l<o.startCropX,r?c?"nw":"sw":c?"ne":"se"}resolveMinDimensions(e,a,i=0,s=0){const o=Math.min(i,e.width),l=Math.min(s,e.height);return!a||!o&&!l?[o,l]:a>1?o?[o,o/a]:[l*a,l]:l?[l*a,l]:[o,o/a]}resizeCrop(){const{evData:e}=this,{aspect:a=0,maxWidth:i,maxHeight:s}=this.props,o=this.getBox(),[l,d]=this.resolveMinDimensions(o,a,this.props.minWidth,this.props.minHeight);let c=this.makePixelCrop(o);const r=this.getPointRegion(o,e.ord,l,d),m=e.ord||r;let u=e.clientX-e.startClientX,h=e.clientY-e.startClientY;(l&&m==="nw"||m==="w"||m==="sw")&&(u=Math.min(u,-l)),(d&&m==="nw"||m==="n"||m==="ne")&&(h=Math.min(h,-d));const p={unit:"px",x:0,y:0,width:0,height:0};r==="ne"?(p.x=e.startCropX,p.width=u,a?(p.height=p.width/a,p.y=e.startCropY-p.height):(p.height=Math.abs(h),p.y=e.startCropY-p.height)):r==="se"?(p.x=e.startCropX,p.y=e.startCropY,p.width=u,a?p.height=p.width/a:p.height=h):r==="sw"?(p.x=e.startCropX+u,p.y=e.startCropY,p.width=Math.abs(u),a?p.height=p.width/a:p.height=h):r==="nw"&&(p.x=e.startCropX+u,p.width=Math.abs(u),a?(p.height=p.width/a,p.y=e.startCropY-p.height):(p.height=Math.abs(h),p.y=e.startCropY+h));const x=Le(p,a,r,o.width,o.height,l,d,i,s);return a||A.xyOrds.indexOf(m)>-1?c=x:A.xOrds.indexOf(m)>-1?(c.x=x.x,c.width=x.width):A.yOrds.indexOf(m)>-1&&(c.y=x.y,c.height=x.height),c.x=H(c.x,0,o.width-c.width),c.y=H(c.y,0,o.height-c.height),c}renderCropSelection(){const{ariaLabels:e=A.defaultProps.ariaLabels,disabled:a,locked:i,renderSelectionAddon:s,ruleOfThirds:o,crop:l}=this.props,d=this.getCropStyle();if(l)return g.createElement("div",{style:d,className:"ReactCrop__crop-selection",onPointerDown:this.onCropPointerDown,"aria-label":e.cropArea,tabIndex:0,onKeyDown:this.onComponentKeyDown,role:"group"},!a&&!i&&g.createElement("div",{className:"ReactCrop__drag-elements",onFocus:this.onDragFocus},g.createElement("div",{className:"ReactCrop__drag-bar ord-n","data-ord":"n"}),g.createElement("div",{className:"ReactCrop__drag-bar ord-e","data-ord":"e"}),g.createElement("div",{className:"ReactCrop__drag-bar ord-s","data-ord":"s"}),g.createElement("div",{className:"ReactCrop__drag-bar ord-w","data-ord":"w"}),g.createElement("div",{className:"ReactCrop__drag-handle ord-nw","data-ord":"nw",tabIndex:0,"aria-label":e.nwDragHandle,onKeyDown:c=>this.onHandlerKeyDown(c,"nw"),role:"button"}),g.createElement("div",{className:"ReactCrop__drag-handle ord-n","data-ord":"n",tabIndex:0,"aria-label":e.nDragHandle,onKeyDown:c=>this.onHandlerKeyDown(c,"n"),role:"button"}),g.createElement("div",{className:"ReactCrop__drag-handle ord-ne","data-ord":"ne",tabIndex:0,"aria-label":e.neDragHandle,onKeyDown:c=>this.onHandlerKeyDown(c,"ne"),role:"button"}),g.createElement("div",{className:"ReactCrop__drag-handle ord-e","data-ord":"e",tabIndex:0,"aria-label":e.eDragHandle,onKeyDown:c=>this.onHandlerKeyDown(c,"e"),role:"button"}),g.createElement("div",{className:"ReactCrop__drag-handle ord-se","data-ord":"se",tabIndex:0,"aria-label":e.seDragHandle,onKeyDown:c=>this.onHandlerKeyDown(c,"se"),role:"button"}),g.createElement("div",{className:"ReactCrop__drag-handle ord-s","data-ord":"s",tabIndex:0,"aria-label":e.sDragHandle,onKeyDown:c=>this.onHandlerKeyDown(c,"s"),role:"button"}),g.createElement("div",{className:"ReactCrop__drag-handle ord-sw","data-ord":"sw",tabIndex:0,"aria-label":e.swDragHandle,onKeyDown:c=>this.onHandlerKeyDown(c,"sw"),role:"button"}),g.createElement("div",{className:"ReactCrop__drag-handle ord-w","data-ord":"w",tabIndex:0,"aria-label":e.wDragHandle,onKeyDown:c=>this.onHandlerKeyDown(c,"w"),role:"button"})),s&&g.createElement("div",{className:"ReactCrop__selection-addon",onPointerDown:c=>c.stopPropagation()},s(this.state)),o&&g.createElement(g.Fragment,null,g.createElement("div",{className:"ReactCrop__rule-of-thirds-hz"}),g.createElement("div",{className:"ReactCrop__rule-of-thirds-vt"})))}makePixelCrop(e){const a={...le,...this.props.crop||{}};return N(a,e.width,e.height)}render(){const{aspect:e,children:a,circularCrop:i,className:s,crop:o,disabled:l,locked:d,style:c,ruleOfThirds:r}=this.props,{cropIsActive:m,newCropIsBeingDrawn:u}=this.state,h=o?this.renderCropSelection():null,p=ja("ReactCrop",s,m&&"ReactCrop--active",l&&"ReactCrop--disabled",d&&"ReactCrop--locked",u&&"ReactCrop--new-crop",o&&e&&"ReactCrop--fixed-aspect",o&&i&&"ReactCrop--circular-crop",o&&r&&"ReactCrop--rule-of-thirds",!this.dragStarted&&o&&!o.width&&!o.height&&"ReactCrop--invisible-crop",i&&"ReactCrop--no-animate");return g.createElement("div",{ref:this.componentRef,className:p,style:c},g.createElement("div",{ref:this.mediaRef,className:"ReactCrop__child-wrapper",onPointerDown:this.onComponentPointerDown},a),o?g.createElement("svg",{className:"ReactCrop__crop-mask",width:"100%",height:"100%"},g.createElement("defs",null,g.createElement("mask",{id:`hole-${this.instanceId}`},g.createElement("rect",{width:"100%",height:"100%",fill:"white"}),i?g.createElement("ellipse",{cx:`${o.x+o.width/2}${o.unit}`,cy:`${o.y+o.height/2}${o.unit}`,rx:`${o.width/2}${o.unit}`,ry:`${o.height/2}${o.unit}`,fill:"black"}):g.createElement("rect",{x:`${o.x}${o.unit}`,y:`${o.y}${o.unit}`,width:`${o.width}${o.unit}`,height:`${o.height}${o.unit}`,fill:"black"}))),g.createElement("rect",{fill:"black",fillOpacity:.5,width:"100%",height:"100%",mask:`url(#hole-${this.instanceId})`})):void 0,h)}};D.xOrds=["e","w"],D.yOrds=["n","s"],D.xyOrds=["nw","ne","se","sw"],D.nudgeStep=1,D.nudgeStepMedium=10,D.nudgeStepLarge=100,D.defaultProps={ariaLabels:{cropArea:"Use the arrow keys to move the crop selection area",nwDragHandle:"Use the arrow keys to move the north west drag handle to change the crop selection area",nDragHandle:"Use the up and down arrow keys to move the north drag handle to change the crop selection area",neDragHandle:"Use the arrow keys to move the north east drag handle to change the crop selection area",eDragHandle:"Use the up and down arrow keys to move the east drag handle to change the crop selection area",seDragHandle:"Use the arrow keys to move the south east drag handle to change the crop selection area",sDragHandle:"Use the up and down arrow keys to move the south drag handle to change the crop selection area",swDragHandle:"Use the arrow keys to move the south west drag handle to change the crop selection area",wDragHandle:"Use the up and down arrow keys to move the west drag handle to change the crop selection area"}};let Ma=D;globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(t,e){return this.cache.has(t)?this.cache.get(t):(this.cache.set(t,e),e)}};const I=globalThis.jotaiAtomCache.get("/home/yepyep/dac/dacademy2/src/atoms/frontMatterAtom.ts/frontMatterAtom",E("frontMatter",{}));I.debugLabel="frontMatterAtom";const Xe=globalThis.jotaiAtomCache.get("/home/yepyep/dac/dacademy2/src/atoms/frontMatterAtom.ts/coverAtom",j(t=>{var e;return(e=t(I))==null?void 0:e.cover},(t,e,a)=>e(I,i=>({...i,cover:a}))));Xe.debugLabel="coverAtom";const ze=globalThis.jotaiAtomCache.get("/home/yepyep/dac/dacademy2/src/atoms/frontMatterAtom.ts/titleAtom",j(t=>{var e;return(e=t(I))==null?void 0:e.title},(t,e,a)=>e(I,i=>({...i,title:a}))));ze.debugLabel="titleAtom";const Ve=globalThis.jotaiAtomCache.get("/home/yepyep/dac/dacademy2/src/atoms/frontMatterAtom.ts/introAtom",j(t=>{var e;return(e=t(I))==null?void 0:e.introduction},(t,e,a)=>e(I,i=>({...i,introduction:a}))));Ve.debugLabel="introAtom";globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(t,e){return this.cache.has(t)?this.cache.get(t):(this.cache.set(t,e),e)}};const Da=(t,e,a)=>Ta(Aa({unit:"%",width:100},a,t,e),t,e),Ra=({image:t})=>{const[e,a]=y.useState(t),i=y.useRef(null),[s,o]=y.useState(),l={width:320,height:480},[d,c]=T(Xe);function r(h){if(h.target.files&&h.target.files.length>0){c(null),o(void 0);const p=new FileReader;p.addEventListener("load",()=>{var x;return a(((x=p.result)==null?void 0:x.toString())||"")}),p.readAsDataURL(h.target.files[0])}}function m(h){if(l){const{width:p,height:x}=h.currentTarget;o(Da(p,x,l.width/l.height))}}async function u(){const h=i.current;if(!h||!s)throw new Error("Crop canvas does not exist.");const p=document.createElement("canvas");p.width=l.width,p.height=l.height;const x=p.getContext("2d");if(!x)throw new Error("No 2d context");s.unit==="px"&&(s.x=s.x/h.width*100,s.y=s.y/h.height*100,s.width=s.width/h.width*100,s.height=s.height/h.height*100),x.imageSmoothingQuality="high";const f={x:h.naturalWidth*(s.x/100),y:h.naturalHeight*(s.y/100)};x.drawImage(h,f.x,f.y,h.naturalWidth*(s.width/100),h.naturalHeight*(s.height/100),0,0,p.width,p.height);const w=p.toDataURL("image/jpeg");localStorage.setItem("cover",w),c(w)}return n.jsxs("div",{className:"",children:[n.jsx("div",{className:"Crop-Controls",children:n.jsxs("label",{className:"flex justify-center mt-4",children:[d&&n.jsx("img",{src:d,alt:"Crop Preview",className:"max-h-[50vh]"}),!t&&n.jsx("input",{type:"file",accept:"image/*",onChange:r,className:Nt(!!d&&"hidden","file-input file-input-bordered w-full max-w-xs")})]})}),!!e&&!d&&n.jsx(Ma,{crop:s,onChange:h=>o(h),aspect:l.width/l.height,minHeight:100,className:"max-h-[50vh]",children:n.jsx("img",{ref:i,alt:"Crop me",src:e,onLoad:m})}),!!s&&!d&&n.jsx("div",{children:n.jsx(Z,{className:"rounded-md my-4",onClick:u,children:"Crop"})})]})};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(t,e){return this.cache.has(t)?this.cache.get(t):(this.cache.set(t,e),e)}};const Ia=()=>n.jsx(Ra,{});globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(t,e){return this.cache.has(t)?this.cache.get(t):(this.cache.set(t,e),e)}};function Sa(){return n.jsxs(K,{className:"w-full",children:[n.jsx(Y,{children:n.jsx(X,{className:"text-center text-xl",children:"Upload Cover"})}),n.jsx(z,{className:"text-center",children:n.jsx(Ia,{})})]})}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(t,e){return this.cache.has(t)?this.cache.get(t):(this.cache.set(t,e),e)}};const be=y.forwardRef(({className:t,...e},a)=>n.jsx("textarea",{className:ee("flex min-h-[60px] w-full rounded-md border border-input bg-transparent px-3 py-2 text-base shadow-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),ref:a,...e}));be.displayName="Textarea";globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(t,e){return this.cache.has(t)?this.cache.get(t):(this.cache.set(t,e),e)}};function _a(){const[t,e]=T(Ve);return n.jsxs(K,{className:"w-full",children:[n.jsx(Y,{children:n.jsx(X,{className:"text-center text-xl",children:"Book Introduction"})}),n.jsx(z,{className:"text-center",children:n.jsx(be,{value:t??"",onChange:({target:{value:a}})=>e(a)})})]})}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(t,e){return this.cache.has(t)?this.cache.get(t):(this.cache.set(t,e),e)}};const Pa=({index:t,header:e,contentHeader:a,onDelete:i,atom:s})=>{const o=g.useRef(null),[l,d]=T(s);return n.jsxs(K,{className:"w-full",children:[n.jsx(Y,{children:n.jsx(X,{className:"text-center text-xl",children:"Book Chapters"})}),n.jsx(z,{className:"text-center",children:n.jsxs("fieldset",{className:"relative border border-secondary p-4 w-full",children:[n.jsx("legend",{className:"text-left",children:e??`Chapter ${t}`}),!!i&&n.jsx("button",{className:"absolute top-8 right-8",onClick:()=>i(t),children:"ðŸ—‘ï¸"}),n.jsxs("div",{id:`chapter-${t}-title`,className:"mb-4 bg-secondary/25 scroll-m-24",children:[n.jsx("h2",{children:"Title"}),n.jsx("input",{onChange:({target:{value:c}})=>{d(r=>({...r,title:c}))},value:l.title??"",id:"title",placeholder:"Title",className:"input input-bordered w-full max-w-xs my-2"})]}),n.jsx("div",{id:`chapter-${t}-content`,className:"mt-4 mb-4 bg-secondary/25 scroll-m-24",children:n.jsx("h2",{className:"mt-2",children:a??`Chapter ${t} Content`})}),n.jsx("div",{className:"flex justify-center",children:n.jsx(ta,{editorRef:o,markdown:l.content??"",className:"dark-theme dark-editor content",onChange:()=>{d(c=>{var r;return{...c,content:((r=o.current)==null?void 0:r.getMarkdown())??""}})}})})]})})]})};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(t,e){return this.cache.has(t)?this.cache.get(t):(this.cache.set(t,e),e)}};const Ce=globalThis.jotaiAtomCache.get("/home/yepyep/dac/dacademy2/src/atoms/usersAtom.ts/usersAtom",E("users",[]));Ce.debugLabel="usersAtom";globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(t,e){return this.cache.has(t)?this.cache.get(t):(this.cache.set(t,e),e)}};function Ea(){const[t,e]=y.useState(),[a,i]=y.useState("reviewer"),[s,o]=T(Ce),l=async()=>{try{if(!t)return;const c=na({chain:kt,transport:Mt()}),r={role:a};if(/^0x(\d|[a-f]){40}$/i.test(t))r.address=t,r.name=await c.getEnsName({address:t})??void 0;else if(Dt(t)){if(r.name=t,r.address=await c.getEnsAddress({name:t})??void 0,!r.address)throw new Error(`${t} is not a valid ENS name.`)}else throw new Error(`Invalid name: ${t}`);o(m=>[...m,r]),e("")}catch(c){Rt.error(c.message)}},d=c=>{o(r=>r.toSpliced(c,1))};return n.jsxs(K,{className:"w-full",children:[n.jsx(Y,{children:n.jsx(X,{className:"text-center text-xl",children:"Permissions"})}),n.jsxs(z,{className:"text-center",children:[n.jsxs("div",{className:"flex gap-4",children:[n.jsx("input",{required:!0,value:t,onChange:({target:{value:c}})=>e(c),className:"grow",placeholder:"ETH Address or ENS Name"}),n.jsxs("select",{value:a,onChange:({target:{value:c}})=>i(c),children:[n.jsx("option",{value:"owner",children:"Owner"}),n.jsx("option",{value:"admin",children:"Admin"}),n.jsx("option",{value:"editor",children:"Editor"}),n.jsx("option",{value:"reviewer",children:"Reviewer"})]}),n.jsx(Z,{onClick:l,children:"Add"})]}),n.jsxs(zt,{children:[n.jsx(Vt,{children:n.jsxs(Pe,{children:[n.jsx(ne,{className:"w-[100px]",children:"ENS Name"}),n.jsx(ne,{children:"ETH Address"}),n.jsx(ne,{children:"Role"}),n.jsx(ne,{className:"text-right"})]})}),n.jsx(qt,{children:s.map((c,r)=>{var m,u;return n.jsxs(Pe,{children:[n.jsx(se,{className:"font-medium",children:c.name}),n.jsx(se,{children:`${(m=c.address)==null?void 0:m.substring(0,5)}â€¦${(u=c.address)==null?void 0:u.slice(-3)}`}),n.jsx(se,{children:c.role}),n.jsx(se,{children:n.jsx(Z,{onClick:()=>d(r),children:"Remove"})})]},r)})})]})]})]})}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(t,e){return this.cache.has(t)?this.cache.get(t):(this.cache.set(t,e),e)}};function $a(){const[t,e]=T(ze);return n.jsxs(K,{className:"w-full",children:[n.jsx(Y,{children:n.jsx(X,{className:"text-center text-xl",children:"Book Title"})}),n.jsx(z,{className:"text-center",children:n.jsx("div",{className:"flex w-full max-w-sm items-center space-x-2 mx-auto",children:n.jsx(sa,{value:t??"",onChange:({target:{value:a}})=>e(a),placeholder:"Book Title"})})})]})}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(t,e){return this.cache.has(t)?this.cache.get(t):(this.cache.set(t,e),e)}};const $=globalThis.jotaiAtomCache.get("/home/yepyep/dac/dacademy2/src/atoms/nftTemplateAtom.ts/nftTemplateAtom",E("nftTemplate",{}));$.debugLabel="nftTemplateAtom";const qe=globalThis.jotaiAtomCache.get("/home/yepyep/dac/dacademy2/src/atoms/nftTemplateAtom.ts/backgroundAtom",j(t=>{var e;return(e=t($))==null?void 0:e.background},(t,e,a)=>e($,i=>({...i,background:a}))));qe.debugLabel="backgroundAtom";const Qe=globalThis.jotaiAtomCache.get("/home/yepyep/dac/dacademy2/src/atoms/nftTemplateAtom.ts/titleAtom",j(t=>{var e;return(e=t($))==null?void 0:e.title},(t,e,a)=>e($,i=>({...i,title:a}))));Qe.debugLabel="titleAtom";const Ge=globalThis.jotaiAtomCache.get("/home/yepyep/dac/dacademy2/src/atoms/nftTemplateAtom.ts/colorAtom",j(t=>{var e;return(e=t($))==null?void 0:e.color},(t,e,a)=>e($,i=>({...i,color:a}))));Ge.debugLabel="colorAtom";globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(t,e){return this.cache.has(t)?this.cache.get(t):(this.cache.set(t,e),e)}};const Ua=({bg:t,title:e,color:a,svgRef:i})=>{const[s,o]=T(qe);return y.useEffect(()=>{t?He(t,o):o(null)},[t]),n.jsxs("svg",{ref:i,version:"1.1",viewBox:"0 0 200 200",xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%",id:"nft",children:[n.jsxs("defs",{children:[s&&n.jsx("image",{id:"bg",href:s}),n.jsx("filter",{id:"blur",colorInterpolationFilters:"sRGB",children:n.jsx("feGaussianBlur",{stdDeviation:"2"})}),n.jsx("rect",{id:"textBox",x:"15%",y:"80%",width:"70%",height:"13%",rx:"4%"}),n.jsx("clipPath",{id:"textClip",children:n.jsx("use",{href:"#textBox"})})]}),s&&n.jsx("g",{children:n.jsx("use",{height:"100%",width:"100%",href:"#bg"})}),e&&n.jsxs(n.Fragment,{children:[n.jsx("use",{filter:"url(#blur)",clipPath:"url(#textClip)",href:"#bg",height:"100%",width:"100%"}),n.jsx("use",{href:"#textBox",fill:"#fff",fillOpacity:".25",filter:"url(#blur)"}),n.jsx("text",{x:"50%",y:"90%",fill:a??"black",fontSize:"133%",stroke:"#0005",strokeWidth:".5",textAnchor:"middle",style:{fontVariationSettings:"'wdth' 87, 'wght' 500"},children:e})]})]})};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(t,e){return this.cache.has(t)?this.cache.get(t):(this.cache.set(t,e),e)}};const S=globalThis.jotaiAtomCache.get("/home/yepyep/dac/dacademy2/src/atoms/nftAtom.ts/nftAtom",E("nft",{}));S.debugLabel="nftAtom";const We=globalThis.jotaiAtomCache.get("/home/yepyep/dac/dacademy2/src/atoms/nftAtom.ts/imageAtom",j(t=>{var e;return(e=t(S))==null?void 0:e.image},(t,e,a)=>e(S,i=>({...i,image:a}))));We.debugLabel="imageAtom";const Je=globalThis.jotaiAtomCache.get("/home/yepyep/dac/dacademy2/src/atoms/nftAtom.ts/nameAtom",j(t=>{var e;return(e=t(S))==null?void 0:e.name},(t,e,a)=>e(S,i=>({...i,name:a}))));Je.debugLabel="nameAtom";const Ze=globalThis.jotaiAtomCache.get("/home/yepyep/dac/dacademy2/src/atoms/nftAtom.ts/descriptionAtom",j(t=>{var e;return(e=t(S))==null?void 0:e.description},(t,e,a)=>e(S,i=>({...i,description:a}))));Ze.debugLabel="descriptionAtom";var La="Label",et=y.forwardRef((t,e)=>n.jsx(F.label,{...t,ref:e,onMouseDown:a=>{var s;a.target.closest("button, input, select, textarea")||((s=t.onMouseDown)==null||s.call(t,a),!a.defaultPrevented&&a.detail>1&&a.preventDefault())}}));et.displayName=La;var tt=et;globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(t,e){return this.cache.has(t)?this.cache.get(t):(this.cache.set(t,e),e)}};const Ha=It("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),xe=y.forwardRef(({className:t,...e},a)=>n.jsx(tt,{ref:a,className:ee(Ha(),t),...e}));xe.displayName=tt.displayName;globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(t,e){return this.cache.has(t)?this.cache.get(t):(this.cache.set(t,e),e)}};const Oa=()=>{const[t,e]=y.useState(),[a,i]=T(Qe),[s,o]=T(Ge),l=y.useRef(),d=Oe(We),[c,r]=T(Je),[m,u]=T(Ze);return y.useEffect(()=>{var x;const h=(x=l.current)==null?void 0:x.outerHTML;if(!h)throw new Error("Could not generate SVG.");const p=new File([new Blob([h])],"nft.svg");He(p,d)},[a,s,t]),n.jsxs("form",{className:"relative",id:"img-config",children:[n.jsxs("div",{className:"flex justify-end flex-col gap-4",children:[n.jsx("input",{placeholder:"Name",value:c??"",onChange:({target:{value:h}})=>r(h)}),n.jsx(be,{placeholder:"Description",value:m??"",onChange:({target:{value:h}})=>u(h)}),n.jsxs("div",{className:"flex justify-between",children:[n.jsx("input",{placeholder:"Title",value:a??"",onChange:({target:{value:h}})=>i(h)}),n.jsxs(xe,{children:[n.jsx("span",{className:"mr-1",children:"Text Color:"}),n.jsx("input",{type:"color",value:s??"",onChange:({target:{value:h}})=>o(h)})]})]})]}),n.jsxs(xe,{className:"",children:[!t&&n.jsxs("div",{className:"flex flex-col items-center absolute top-1/2 left-1/2 -translate-x-1/2",children:[n.jsx(wa,{size:48}),n.jsx("h3",{children:"Upload NFT Image"})]}),n.jsx(Ua,{bg:t,title:a,color:s,svgRef:l}),n.jsx("input",{className:"hidden",onChange:({target:{files:h}})=>e(h==null?void 0:h[0]),type:"file",accept:"image/*"})]})]})};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(t,e){return this.cache.has(t)?this.cache.get(t):(this.cache.set(t,e),e)}};function Ba(){return n.jsxs(K,{className:"w-full",children:[n.jsx(Y,{children:n.jsx(X,{className:"text-center text-xl",children:"Upload Completion NFT"})}),n.jsx(z,{className:"text-center",children:n.jsx(Oa,{})})]})}var ve="Collapsible",[Fa,at]=Be(ve),[Ka,je]=Fa(ve),nt=y.forwardRef((t,e)=>{const{__scopeCollapsible:a,open:i,defaultOpen:s,disabled:o,onOpenChange:l,...d}=t,[c=!1,r]=we({prop:i,defaultProp:s,onChange:l});return n.jsx(Ka,{scope:a,disabled:o,contentId:Fe(),open:c,onOpenToggle:y.useCallback(()=>r(m=>!m),[r]),children:n.jsx(F.div,{"data-state":Te(c),"data-disabled":o?"":void 0,...d,ref:e})})});nt.displayName=ve;var st="CollapsibleTrigger",ot=y.forwardRef((t,e)=>{const{__scopeCollapsible:a,...i}=t,s=je(st,a);return n.jsx(F.button,{type:"button","aria-controls":s.contentId,"aria-expanded":s.open||!1,"data-state":Te(s.open),"data-disabled":s.disabled?"":void 0,disabled:s.disabled,...i,ref:e,onClick:Ke(t.onClick,s.onOpenToggle)})});ot.displayName=st;var Ae="CollapsibleContent",it=y.forwardRef((t,e)=>{const{forceMount:a,...i}=t,s=je(Ae,t.__scopeCollapsible);return n.jsx(St,{present:a||s.open,children:({present:o})=>n.jsx(Ya,{...i,ref:e,present:o})})});it.displayName=Ae;var Ya=y.forwardRef((t,e)=>{const{__scopeCollapsible:a,present:i,children:s,...o}=t,l=je(Ae,a),[d,c]=y.useState(i),r=y.useRef(null),m=Ye(e,r),u=y.useRef(0),h=u.current,p=y.useRef(0),x=p.current,f=l.open||d,w=y.useRef(f),v=y.useRef();return y.useEffect(()=>{const b=requestAnimationFrame(()=>w.current=!1);return()=>cancelAnimationFrame(b)},[]),_t(()=>{const b=r.current;if(b){v.current=v.current||{transitionDuration:b.style.transitionDuration,animationName:b.style.animationName},b.style.transitionDuration="0s",b.style.animationName="none";const M=b.getBoundingClientRect();u.current=M.height,p.current=M.width,w.current||(b.style.transitionDuration=v.current.transitionDuration,b.style.animationName=v.current.animationName),c(i)}},[l.open,i]),n.jsx(F.div,{"data-state":Te(l.open),"data-disabled":l.disabled?"":void 0,id:l.contentId,hidden:!f,...o,ref:m,style:{"--radix-collapsible-content-height":h?`${h}px`:void 0,"--radix-collapsible-content-width":x?`${x}px`:void 0,...t.style},children:f&&s})});function Te(t){return t?"open":"closed"}var Xa=nt,za=ot,Va=it,k="Accordion",qa=["Home","End","ArrowDown","ArrowUp","ArrowLeft","ArrowRight"],[Ne,Qa,Ga]=Pt(k),[pe,_n]=Be(k,[Ga,at]),ke=at(),rt=g.forwardRef((t,e)=>{const{type:a,...i}=t,s=i,o=i;return n.jsx(Ne.Provider,{scope:t.__scopeAccordion,children:a==="multiple"?n.jsx(en,{...o,ref:e}):n.jsx(Za,{...s,ref:e})})});rt.displayName=k;var[ct,Wa]=pe(k),[lt,Ja]=pe(k,{collapsible:!1}),Za=g.forwardRef((t,e)=>{const{value:a,defaultValue:i,onValueChange:s=()=>{},collapsible:o=!1,...l}=t,[d,c]=we({prop:a,defaultProp:i,onChange:s});return n.jsx(ct,{scope:t.__scopeAccordion,value:d?[d]:[],onItemOpen:c,onItemClose:g.useCallback(()=>o&&c(""),[o,c]),children:n.jsx(lt,{scope:t.__scopeAccordion,collapsible:o,children:n.jsx(dt,{...l,ref:e})})})}),en=g.forwardRef((t,e)=>{const{value:a,defaultValue:i,onValueChange:s=()=>{},...o}=t,[l=[],d]=we({prop:a,defaultProp:i,onChange:s}),c=g.useCallback(m=>d((u=[])=>[...u,m]),[d]),r=g.useCallback(m=>d((u=[])=>u.filter(h=>h!==m)),[d]);return n.jsx(ct,{scope:t.__scopeAccordion,value:l,onItemOpen:c,onItemClose:r,children:n.jsx(lt,{scope:t.__scopeAccordion,collapsible:!0,children:n.jsx(dt,{...o,ref:e})})})}),[tn,me]=pe(k),dt=g.forwardRef((t,e)=>{const{__scopeAccordion:a,disabled:i,dir:s,orientation:o="vertical",...l}=t,d=g.useRef(null),c=Ye(d,e),r=Qa(a),u=Et(s)==="ltr",h=Ke(t.onKeyDown,p=>{var L;if(!qa.includes(p.key))return;const x=p.target,f=r().filter(P=>{var q;return!((q=P.ref.current)!=null&&q.disabled)}),w=f.findIndex(P=>P.ref.current===x),v=f.length;if(w===-1)return;p.preventDefault();let b=w;const M=0,_=v-1,U=()=>{b=w+1,b>_&&(b=M)},V=()=>{b=w-1,b<M&&(b=_)};switch(p.key){case"Home":b=M;break;case"End":b=_;break;case"ArrowRight":o==="horizontal"&&(u?U():V());break;case"ArrowDown":o==="vertical"&&U();break;case"ArrowLeft":o==="horizontal"&&(u?V():U());break;case"ArrowUp":o==="vertical"&&V();break}const ue=b%v;(L=f[ue].ref.current)==null||L.focus()});return n.jsx(tn,{scope:a,disabled:i,direction:s,orientation:o,children:n.jsx(Ne.Slot,{scope:a,children:n.jsx(F.div,{...l,"data-orientation":o,ref:c,onKeyDown:i?void 0:h})})})}),de="AccordionItem",[an,Me]=pe(de),ht=g.forwardRef((t,e)=>{const{__scopeAccordion:a,value:i,...s}=t,o=me(de,a),l=Wa(de,a),d=ke(a),c=Fe(),r=i&&l.value.includes(i)||!1,m=o.disabled||t.disabled;return n.jsx(an,{scope:a,open:r,disabled:m,triggerId:c,children:n.jsx(Xa,{"data-orientation":o.orientation,"data-state":xt(r),...d,...s,ref:e,disabled:m,open:r,onOpenChange:u=>{u?l.onItemOpen(i):l.onItemClose(i)}})})});ht.displayName=de;var pt="AccordionHeader",mt=g.forwardRef((t,e)=>{const{__scopeAccordion:a,...i}=t,s=me(k,a),o=Me(pt,a);return n.jsx(F.h3,{"data-orientation":s.orientation,"data-state":xt(o.open),"data-disabled":o.disabled?"":void 0,...i,ref:e})});mt.displayName=pt;var fe="AccordionTrigger",ut=g.forwardRef((t,e)=>{const{__scopeAccordion:a,...i}=t,s=me(k,a),o=Me(fe,a),l=Ja(fe,a),d=ke(a);return n.jsx(Ne.ItemSlot,{scope:a,children:n.jsx(za,{"aria-disabled":o.open&&!l.collapsible||void 0,"data-orientation":s.orientation,id:o.triggerId,...d,...i,ref:e})})});ut.displayName=fe;var gt="AccordionContent",yt=g.forwardRef((t,e)=>{const{__scopeAccordion:a,...i}=t,s=me(k,a),o=Me(gt,a),l=ke(a);return n.jsx(Va,{role:"region","aria-labelledby":o.triggerId,"data-orientation":s.orientation,...l,...i,ref:e,style:{"--radix-accordion-content-height":"var(--radix-collapsible-content-height)","--radix-accordion-content-width":"var(--radix-collapsible-content-width)",...t.style}})});yt.displayName=gt;function xt(t){return t?"open":"closed"}var nn=rt,sn=ht,on=mt,ft=ut,wt=yt;globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(t,e){return this.cache.has(t)?this.cache.get(t):(this.cache.set(t,e),e)}};const rn=nn,oe=y.forwardRef(({className:t,...e},a)=>n.jsx(sn,{ref:a,className:ee("border-b",t),...e}));oe.displayName="AccordionItem";const ie=y.forwardRef(({className:t,children:e,...a},i)=>n.jsx(on,{className:"flex",children:n.jsxs(ft,{ref:i,className:ee("flex flex-1 items-center justify-between py-4 text-sm font-medium transition-all hover:underline text-left [&[data-state=open]>svg]:rotate-180",t),...a,children:[e,n.jsx($t,{className:"h-4 w-4 shrink-0 text-muted-foreground transition-transform duration-200"})]})}));ie.displayName=ft.displayName;const re=y.forwardRef(({className:t,children:e,...a},i)=>n.jsx(wt,{ref:i,className:"overflow-hidden text-sm data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down",...a,children:n.jsx("div",{className:ee("pb-4 pt-0",t),children:e})}));re.displayName=wt.displayName;globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(t,e){return this.cache.has(t)?this.cache.get(t):(this.cache.set(t,e),e)}};const he=globalThis.jotaiAtomCache.get("/home/yepyep/dac/dacademy2/src/atoms/chapterAtom.ts/chapterIdsAtom",E("chapterIds",[],void 0,{getOnInit:!0}));he.debugLabel="chapterIdsAtom";const De=globalThis.jotaiAtomCache.get("/home/yepyep/dac/dacademy2/src/atoms/chapterAtom.ts/chaptersAtomsAtom",j(t=>t(he).map(e=>E(`chapter-${e}`,{},void 0,{getOnInit:!0})),(t,e,a)=>{const i=crypto.randomUUID(),s=E(`chapter-${i}`,a);s.debugLabel="chapterAtom",s.debugLabel="chapterAtom",e(s,a),e(he,o=>[...o,i])}));De.debugLabel="chaptersAtomsAtom";const bt=globalThis.jotaiAtomCache.get("/home/yepyep/dac/dacademy2/src/atoms/chapterAtom.ts/removeChapterAtom",j(null,(t,e,a)=>{e(he,i=>i.toSpliced(a,1))}));bt.debugLabel="removeChapterAtom";const Ct=globalThis.jotaiAtomCache.get("/home/yepyep/dac/dacademy2/src/atoms/chapterAtom.ts/chaptersAtom",j(t=>t(De).map(e=>t(e))));Ct.debugLabel="chaptersAtom";const cn=[{inputs:[{internalType:"address",name:"_template",type:"address"},{internalType:"address",name:"_admin",type:"address"},{internalType:"address",name:"_treasury",type:"address"},{internalType:"address",name:"_paymentToken",type:"address"},{internalType:"uint256",name:"_upgradeFee",type:"uint256"}],stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!1,internalType:"address",name:"proposedAdmin",type:"address"}],name:"AdminReplaceProposed",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"address",name:"admin",type:"address"}],name:"AdminReplaced",type:"event"},{anonymous:!1,inputs:[],name:"FactorySetup",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"address",name:"proposedPaymentToken",type:"address"}],name:"PaymentTokenReplaceProposed",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"contract IERC20Token",name:"paymentToken",type:"address"}],name:"PaymentTokenReplaced",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint256",name:"index",type:"uint256"},{indexed:!1,internalType:"address",name:"questChain",type:"address"}],name:"QuestChainCreated",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"address",name:"sender",type:"address"},{indexed:!1,internalType:"address",name:"questChain",type:"address"}],name:"QuestChainUpgraded",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint256",name:"proposedUpgradeFee",type:"uint256"}],name:"UpgradeFeeReplaceProposed",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint256",name:"upgradeFee",type:"uint256"}],name:"UpgradeFeeReplaced",type:"event"},{inputs:[],name:"admin",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"adminProposalTimestamp",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{components:[{internalType:"address[]",name:"owners",type:"address[]"},{internalType:"address[]",name:"admins",type:"address[]"},{internalType:"address[]",name:"editors",type:"address[]"},{internalType:"address[]",name:"reviewers",type:"address[]"},{internalType:"string[]",name:"quests",type:"string[]"},{internalType:"bool",name:"paused",type:"bool"},{internalType:"string",name:"details",type:"string"},{internalType:"string",name:"tokenURI",type:"string"}],internalType:"struct QuestChainCommons.QuestChainInfo",name:"_info",type:"tuple"},{internalType:"bytes32",name:"_salt",type:"bytes32"}],name:"create",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"nonpayable",type:"function"},{inputs:[{components:[{internalType:"address[]",name:"owners",type:"address[]"},{internalType:"address[]",name:"admins",type:"address[]"},{internalType:"address[]",name:"editors",type:"address[]"},{internalType:"address[]",name:"reviewers",type:"address[]"},{internalType:"string[]",name:"quests",type:"string[]"},{internalType:"bool",name:"paused",type:"bool"},{internalType:"string",name:"details",type:"string"},{internalType:"string",name:"tokenURI",type:"string"}],internalType:"struct QuestChainCommons.QuestChainInfo",name:"_info",type:"tuple"},{internalType:"bytes32",name:"_salt",type:"bytes32"}],name:"createAndUpgrade",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"nonpayable",type:"function"},{inputs:[{components:[{internalType:"address[]",name:"owners",type:"address[]"},{internalType:"address[]",name:"admins",type:"address[]"},{internalType:"address[]",name:"editors",type:"address[]"},{internalType:"address[]",name:"reviewers",type:"address[]"},{internalType:"string[]",name:"quests",type:"string[]"},{internalType:"bool",name:"paused",type:"bool"},{internalType:"string",name:"details",type:"string"},{internalType:"string",name:"tokenURI",type:"string"}],internalType:"struct QuestChainCommons.QuestChainInfo",name:"_info",type:"tuple"},{internalType:"bytes32",name:"_salt",type:"bytes32"},{internalType:"uint256",name:"_deadline",type:"uint256"},{internalType:"bytes",name:"_signature",type:"bytes"}],name:"createAndUpgradeWithPermit",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"executeAdminReplace",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"executePaymentTokenReplace",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"executeUpgradeFeeReplace",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"_index",type:"uint256"}],name:"getQuestChainAddress",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"paymentToken",outputs:[{internalType:"contract IERC20Token",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"paymentTokenProposalTimestamp",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"_admin",type:"address"}],name:"proposeAdminReplace",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"_paymentToken",type:"address"}],name:"proposePaymentTokenReplace",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"_upgradeFee",type:"uint256"}],name:"proposeUpgradeFeeReplace",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"proposedAdmin",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"proposedPaymentToken",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"proposedUpgradeFee",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"questChainCount",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"questChainTemplate",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"questChainToken",outputs:[{internalType:"contract IQuestChainToken",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"treasury",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"upgradeFee",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"upgradeFeeProposalTimestamp",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"_questChainAddress",type:"address"}],name:"upgradeQuestChain",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"_questChainAddress",type:"address"},{internalType:"uint256",name:"_deadline",type:"uint256"},{internalType:"bytes",name:"_signature",type:"bytes"}],name:"upgradeQuestChainWithPermit",outputs:[],stateMutability:"nonpayable",type:"function"}];globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(t,e){return this.cache.has(t)?this.cache.get(t):(this.cache.set(t,e),e)}};function ln(){const[t,e]=y.useState(!0),a=oa("(min-width: 768px)"),[i,s]=y.useState([]),o=ae(I),l=ae(Ct),d=ae(S),c=ae(Ce),r=u=>s(h=>[...h,u]),{writeContract:m}=aa();return y.useEffect(()=>{(async()=>{try{if(!o.title)throw new Error("Missing title");if(!o.introduction)throw new Error("Missing introduction");if(!o.cover)throw new Error("missing cover");r("Uploading cover to IPFS.");const u=await fetch(o.cover).then(C=>C.blob()).then(C=>W([new File([C],"cover.jpg")])),h=`ipfs://${u}/cover.jpg`,p=`ipfs://${u.substring(0,3)}â€¦${u.slice(-3)}/cover.jpg`;r(n.jsxs("p",{children:["Saved to ",n.jsx("a",{target:"_blank",href:J(h),children:p}),"."]})),r("Uploading metadata to IPFS.");const x={title:o.title,introduction:o.introduction,cover:h},f=`frontmatter.${new Date().toISOString()}.json`,w=await W([new File([JSON.stringify(x,null,2)],f)]),v=`ipfs://${w}/${f}`,b=`ipfs://${w.substring(0,3)}â€¦${w.slice(-3)}/${f}`;r(n.jsxs("p",{children:["Saved to ",n.jsx("a",{target:"_blank",href:J(v),children:b}),"."]}));const M=await Promise.all(l.map(async C=>{const Q={title:C.title,description:C.content},G=`chapter.${new Date().toISOString()}.json`,ge=await W([new File([JSON.stringify(Q,null,2)],G)]),Ie=`ipfs://${ge}/${G}`,At=`ipfs://${ge.substring(0,3)}â€¦${ge.slice(-3)}/${G}`;return r(n.jsxs("p",{children:["Saved to ",n.jsx("a",{target:"_blank",href:J(Ie),children:At}),"."]})),Ie}));if(!d.image)throw new Error("NFT Missing Image");const _=await fetch(d.image).then(C=>C.blob()).then(C=>W([new File([C],"image.svg")])),U=`ipfs://${_}/image.svg`,V=`ipfs://${_.substring(0,3)}â€¦${_.slice(-3)}/image.svg`;r(n.jsxs("p",{children:["Saved to ",n.jsx("a",{target:"_blank",href:J(U),children:V}),"."]}));const ue={title:d.name,description:d.description,image:U},L=`nft.${new Date().toISOString()}.json`,P=await W([new File([JSON.stringify(ue,null,2)],L)]),q=`ipfs://${P}/${L}`,vt=`ipfs://${P.substring(0,3)}â€¦${P.slice(-3)}/${L}`;r(n.jsxs("p",{children:["Saved to ",n.jsx("a",{target:"_blank",href:J(q),children:vt}),"."]}));const jt=Object.groupBy(c,({role:C})=>C??"unknown"),te=Object.fromEntries(Object.entries(jt).map(([C,Q])=>[C,Q==null?void 0:Q.map(({address:G})=>G)])),Re=[{owners:te.owner??[],admins:te.admin??[],editors:te.editor??[],reviewers:te.reviewer??[],quests:M,paused:!1,details:v,tokenURI:q},`0x${"0".repeat(64)}`];console.log({args:Re}),m({address:"0x0d006D9e862B362180eb602e5973Fd1fdb6f78dd",abi:cn,functionName:"create",args:Re},{onError:C=>{console.error({error:C}),r(C.shortMessage??C.message)},onSuccess:C=>r(n.jsxs("p",{children:["Submitted in transaction",n.jsxs("a",{href:`https://optimistic.etherscan.io/tx/${C}`,className:"mx-1 whitespace-nowrap text-primary hover:text-secondary",target:"_blank",children:[C.substring(0,8),"â€¦",C.slice(-6)]}),"."]}))})}catch(u){r(u.message)}finally{}})()},[]),a?n.jsx(ha,{open:t,onOpenChange:e,children:n.jsx(pa,{className:"sm:max-w-[425px]",children:n.jsxs(ma,{children:[n.jsx(ua,{children:"Uploading Playbook"}),n.jsx(ga,{children:n.jsx("ol",{children:i.map(u=>n.jsx("li",{children:u}))})})]})})}):n.jsx(ia,{open:t,onOpenChange:e,children:n.jsx(ra,{children:n.jsxs(ca,{className:"text-left",children:[n.jsx(la,{children:"Uploading Playbook"}),n.jsx(da,{children:n.jsx("ol",{children:i.map(u=>n.jsx("li",{children:u}))})})]})})})}globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(t,e){return this.cache.has(t)?this.cache.get(t):(this.cache.set(t,e),e)}};const dn=()=>{const[t,e]=y.useState("item-1"),[a,i]=T(De),s=Oe(bt),[o,l]=y.useState(!1);y.useEffect(()=>{window.scrollTo(0,0)},[]);const d=c=>{s(c-1)};return y.useEffect(()=>{var r;const c=(r=ce.find(m=>m.value===t))==null?void 0:r.url;if(c){const m=document.querySelector(c);m&&setTimeout(()=>{m.scrollIntoView({behavior:"smooth",block:"start"})},300)}},[t,ce]),n.jsxs(Qt,{children:[n.jsx(va,{onAccordionChange:e}),n.jsx(Gt,{}),n.jsxs("main",{className:"flex-1 mt-12 w-screen mb-8",children:[n.jsxs("div",{className:"space-y-4 mx-auto w-2/3",children:[n.jsxs(rn,{type:"single",collapsible:!0,className:"w-full",value:t,onValueChange:e,children:[n.jsxs(oe,{value:"item-1",children:[n.jsx(ie,{children:"Upload Cover"}),n.jsx(re,{children:n.jsx("div",{id:"upload-cover",className:"pt-8 scroll-mt-12",children:n.jsx(Sa,{})})})]}),n.jsxs(oe,{value:"item-2",children:[n.jsx(ie,{children:"Upload Title"}),n.jsx(re,{children:n.jsx("div",{id:"book-title",className:"pt-8 scroll-mt-12",children:n.jsx($a,{})})})]}),n.jsxs(oe,{value:"item-3",children:[n.jsx(ie,{children:"Upload Intro"}),n.jsx(re,{children:n.jsx("div",{id:"book-intro",className:"pt-8 scroll-mt-12",children:n.jsx(_a,{})})})]})]}),n.jsxs("div",{id:"chapters",className:"pt-8 scroll-mt-12",children:[a.map((c,r)=>n.jsx(Pa,{atom:c,onDelete:d,index:r+1},r)),n.jsx("div",{className:"flex justify-center mt-4",children:n.jsx(Z,{onClick:()=>i({}),className:"items-center rounded-md",children:"Add Chapter"})})]}),n.jsx("div",{id:"completion",className:"pt-8 scroll-mt-12",children:n.jsx(Ba,{})}),n.jsx("div",{id:"permissions",className:"pt-8 scroll-mt-12",children:n.jsx(Ea,{})}),n.jsx(Z,{onClick:()=>l(!0),className:"secondary",children:"Create Playbook"})]}),o&&n.jsx(ln,{})]})]})},Pn=Ut("/upload/")({component:dn});export{Pn as Route,dn as Upload};
